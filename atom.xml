<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>彭贻豪的博客</title>
  <subtitle>Leo&#39;s blog</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-04-02T07:35:48.978Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>彭贻豪</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>HNOI2012解题报告</title>
    <link href="http://yoursite.com/2017/04/02/HNOI2012%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    <id>http://yoursite.com/2017/04/02/HNOI2012解题报告/</id>
    <published>2017-04-02T07:01:56.000Z</published>
    <updated>2017-04-02T07:35:48.978Z</updated>
    
    <content type="html"><![CDATA[<h2 id="hnoi2012解题报告">HNOI2012解题报告</h2>
<h4 id="author-pengyihao">Author: Pengyihao</h4>
<a id="more"></a>
<hr>
<h3 id="day1-t1-双十字">Day1 T1 双十字</h3>
<hr>
<h4 id="思路">思路</h4>
<p>因为矩阵总的大小不超过 <span class="math inline">\(1000000\)</span>，所以我们可以预处理往左最多能延续多少，往右、往上、往下……</p>
<p>然后我们考虑枚举双十字中间线所在的列。</p>
<p>枚举下面这根横线所在的行。</p>
<p>然后对于这根横线形成的双十字的数量有影响的行，一定在其之上并且长度短于它。</p>
<p>于是对于每段连续的 <span class="math inline">\(1\)</span>，我们维护一个 <span class="math inline">\(splay\)</span>。</p>
<p><span class="math inline">\(splay\)</span> 的关键字键值为左右延伸的长度，然后记录每个点往上扩展的长度以及自身的长度能够给予的贡献。</p>
<p>这个贡献可以求一下子树的和。</p>
<p>那么每次计算下面这根横线的贡献的时候，直接找到它在 <span class="math inline">\(splay\)</span> 中的位置，把它左边、右边的区间提取出来，计算贡献即可。</p>
<p>注意必须在第 <span class="math inline">\(i\)</span> 行的时候插入第 <span class="math inline">\(i-2\)</span> 行，因为两根横线不相邻。</p>
<hr>
<h4 id="代码">代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (LL i = (a), i##_END_ = (b); i &lt;= i##_END_; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DNF(i, a, b) for (LL i = (a), i##_END_ = (b); i &gt;= i##_END_; i--)</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">	<span class="keyword">char</span> ch = getchar(); x = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>) ch = getchar();</div><div class="line">	<span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Max</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmax</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmin</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : x=y;&#125;</div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="built_in">std</span>::<span class="built_in">vector</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> LL MAXN = <span class="number">10010</span>, MOD = <span class="number">1000000009</span>;</div><div class="line"></div><div class="line"><span class="built_in">vector</span>&lt;LL&gt;line[MAXN];</div><div class="line"><span class="built_in">vector</span>&lt;LL&gt;lr[MAXN], tp[MAXN], co[MAXN];</div><div class="line"></div><div class="line">LL r, c, n;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node &#123;</div><div class="line">	Node *ch[<span class="number">2</span>], *fa;</div><div class="line">	LL data1, data2, sum1, sum2, sum3, sz;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(LL, LL)</span></span>;</div><div class="line">	<span class="function">LL <span class="title">get_rnk</span><span class="params">(LL)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(Node*)</span></span>;</div><div class="line">	<span class="function">Node *<span class="title">find_key</span><span class="params">(LL)</span></span>;</div><div class="line">&#125; *treap;</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::rotate()</div><div class="line">&#123;</div><div class="line">	Node *pa = fa;</div><div class="line">	fa = pa -&gt; fa; pa -&gt; fa = <span class="keyword">this</span>;</div><div class="line">	<span class="keyword">if</span> (fa != <span class="literal">NULL</span>) &#123;</div><div class="line">		<span class="keyword">bool</span> t = (fa -&gt; ch[<span class="number">0</span>] == pa ? <span class="number">0</span> : <span class="number">1</span>);</div><div class="line">		fa -&gt; ch[t] = <span class="keyword">this</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">bool</span> t = (pa -&gt; ch[<span class="number">0</span>] == <span class="keyword">this</span> ? <span class="number">0</span> : <span class="number">1</span>);</div><div class="line">	Node *chd = ch[t ^ <span class="number">1</span>];</div><div class="line">	ch[t ^ <span class="number">1</span>] = pa; pa -&gt; ch[t] = chd;</div><div class="line">	<span class="keyword">if</span> (chd != <span class="literal">NULL</span>) chd -&gt; fa = pa;</div><div class="line">	pa -&gt; update(); update();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::splay(Node *top)</div><div class="line">&#123;</div><div class="line">	<span class="keyword">while</span> (fa != top) &#123;</div><div class="line">		<span class="keyword">if</span> (fa -&gt; fa != top) &#123;</div><div class="line">			<span class="keyword">bool</span> t = (fa -&gt; fa -&gt; ch[<span class="number">0</span>] == fa ? <span class="number">0</span> : <span class="number">1</span>);</div><div class="line">			<span class="keyword">if</span> (fa -&gt; ch[t] == <span class="keyword">this</span>) fa -&gt; rotate(), rotate();</div><div class="line">			<span class="keyword">else</span> rotate(), rotate();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> rotate();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (top == <span class="literal">NULL</span>) treap = <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">LL Node::get_rnk(LL now)</div><div class="line">&#123;</div><div class="line">	Node *x = <span class="keyword">this</span>;</div><div class="line"></div><div class="line">	LL ret = <span class="number">0</span>;</div><div class="line">	</div><div class="line">	<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (x -&gt; data1 == now) &#123;</div><div class="line">			<span class="keyword">return</span> (x -&gt; ch[<span class="number">0</span>] == <span class="literal">NULL</span> ? <span class="number">1</span> : x -&gt; ch[<span class="number">0</span>] -&gt; sz + <span class="number">1</span>) + ret;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (x -&gt; data1 &gt; now) &#123;</div><div class="line">			<span class="keyword">if</span> (x -&gt; ch[<span class="number">0</span>] == <span class="literal">NULL</span>) <span class="keyword">return</span> ret;</div><div class="line">			x = x -&gt; ch[<span class="number">0</span>];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> &#123;</div><div class="line">			<span class="keyword">if</span> (x -&gt; ch[<span class="number">1</span>] == <span class="literal">NULL</span>) <span class="keyword">return</span> x -&gt; sz + ret;</div><div class="line">			ret += (x -&gt; ch[<span class="number">0</span>] == <span class="literal">NULL</span> ? <span class="number">1</span> : x -&gt; ch[<span class="number">0</span>] -&gt; sz + <span class="number">1</span>);</div><div class="line">			x = x -&gt; ch[<span class="number">1</span>];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Node* Node::find_key(LL rnk)</div><div class="line">&#123;</div><div class="line">	Node *x = <span class="keyword">this</span>;</div><div class="line">	<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">		<span class="keyword">if</span> ((x -&gt; ch[<span class="number">0</span>] == <span class="literal">NULL</span> ? <span class="number">1</span> : x -&gt; ch[<span class="number">0</span>] -&gt; sz + <span class="number">1</span>) == rnk) <span class="keyword">return</span> x;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span> ((x -&gt; ch[<span class="number">0</span>] == <span class="literal">NULL</span> ? <span class="number">1</span> : x -&gt; ch[<span class="number">0</span>] -&gt; sz + <span class="number">1</span>) &lt; rnk) &#123;</div><div class="line">			rnk -= (x -&gt; ch[<span class="number">0</span>] == <span class="literal">NULL</span> ? <span class="number">1</span> : x -&gt; ch[<span class="number">0</span>] -&gt; sz + <span class="number">1</span>);</div><div class="line">			x = x -&gt; ch[<span class="number">1</span>];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> x = x -&gt; ch[<span class="number">0</span>];</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::insert(LL now, LL now2)</div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> (treap == <span class="literal">NULL</span>) &#123;</div><div class="line">		Node *hr = <span class="keyword">new</span> Node;</div><div class="line">		hr -&gt; ch[<span class="number">0</span>] = hr -&gt; ch[<span class="number">1</span>] = hr -&gt; fa = <span class="literal">NULL</span>;</div><div class="line">		hr -&gt; data1 = now; hr -&gt; data2 = now2; treap = hr; treap -&gt; update();</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	LL rnk = treap -&gt; get_rnk(now);</div><div class="line">	<span class="keyword">if</span> (rnk == <span class="number">0</span>) &#123;</div><div class="line">		Node *hr = <span class="keyword">new</span> Node;</div><div class="line">		hr -&gt; ch[<span class="number">0</span>] = hr -&gt; fa = <span class="literal">NULL</span>;</div><div class="line">		hr -&gt; ch[<span class="number">1</span>] = treap; hr -&gt; data1 = now; hr -&gt; data2 = now2;</div><div class="line">		treap -&gt; fa = hr; hr -&gt; update();</div><div class="line">		treap = hr;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> <span class="keyword">if</span> (rnk == treap -&gt; sz) &#123;</div><div class="line">		Node *hr = <span class="keyword">new</span> Node;</div><div class="line">		hr -&gt; ch[<span class="number">1</span>] = hr -&gt; fa = <span class="literal">NULL</span>;</div><div class="line">		hr -&gt; ch[<span class="number">0</span>] = treap; hr -&gt; data1 = now; hr -&gt; data2 = now2;</div><div class="line">		treap -&gt; fa = hr; hr -&gt; update();</div><div class="line">		treap = hr; </div><div class="line">	&#125;</div><div class="line">	<span class="keyword">else</span> &#123;</div><div class="line">		Node *hr = <span class="keyword">new</span> Node;</div><div class="line">		treap -&gt; find_key(rnk) -&gt; splay(<span class="literal">NULL</span>);</div><div class="line">		treap -&gt; find_key(rnk + <span class="number">1</span>) -&gt; splay(treap);</div><div class="line">		hr -&gt; data1 = now;</div><div class="line">		hr -&gt; data2 = now2;</div><div class="line">		hr -&gt; ch[<span class="number">0</span>] = <span class="literal">NULL</span>;</div><div class="line">		hr -&gt; ch[<span class="number">1</span>] = treap -&gt; ch[<span class="number">1</span>];</div><div class="line">		hr -&gt; fa = treap; treap -&gt; ch[<span class="number">1</span>] = hr;</div><div class="line">		hr -&gt; ch[<span class="number">1</span>] -&gt; fa = hr; hr -&gt; update(); treap -&gt; update();</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::clear()</div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> (ch[<span class="number">0</span>] != <span class="literal">NULL</span>) ch[<span class="number">0</span>] -&gt; clear();</div><div class="line">	<span class="keyword">if</span> (ch[<span class="number">1</span>] != <span class="literal">NULL</span>) ch[<span class="number">1</span>] -&gt; clear();</div><div class="line">	<span class="keyword">delete</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::update()</div><div class="line">&#123;</div><div class="line">	sz = <span class="number">1</span>;</div><div class="line">	sum1 = data1 * data2 % MOD;</div><div class="line">	sum2 = (data1 * (data1 + <span class="number">1</span>) / <span class="number">2</span>) * data2 % MOD;</div><div class="line">	sum3 = data2;</div><div class="line"></div><div class="line">	<span class="keyword">if</span> (ch[<span class="number">0</span>] != <span class="literal">NULL</span>) &#123;</div><div class="line">		sz += ch[<span class="number">0</span>] -&gt; sz;</div><div class="line">		sum1 = (sum1 + ch[<span class="number">0</span>] -&gt; sum1) % MOD;</div><div class="line">		sum2 = (sum2 + ch[<span class="number">0</span>] -&gt; sum2) % MOD;</div><div class="line">		sum3 = (sum3 + ch[<span class="number">0</span>] -&gt; sum3) % MOD;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span> (ch[<span class="number">1</span>] != <span class="literal">NULL</span>) &#123;</div><div class="line">		sz += ch[<span class="number">1</span>] -&gt; sz;</div><div class="line">		sum1 = (sum1 + ch[<span class="number">1</span>] -&gt; sum1) % MOD;</div><div class="line">		sum2 = (sum2 + ch[<span class="number">1</span>] -&gt; sum2) % MOD;</div><div class="line">		sum3 = (sum3 + ch[<span class="number">1</span>] -&gt; sum3) % MOD;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"cross.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"cross.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">	</div><div class="line">	in(r); in(c); in(n);</div><div class="line"></div><div class="line">	FOR(i, <span class="number">0</span>, r + <span class="number">1</span>) &#123;</div><div class="line">		lr[i].resize(c + <span class="number">2</span>);</div><div class="line">		tp[i].resize(c + <span class="number">2</span>);</div><div class="line">		co[i].resize(c + <span class="number">2</span>);</div><div class="line">		line[i].resize(c + <span class="number">2</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	FOR(i, <span class="number">1</span>, r) FOR(j, <span class="number">1</span>, c) line[i][j] = <span class="number">1</span>;</div><div class="line">	</div><div class="line">	FOR(i, <span class="number">1</span>, n) &#123;</div><div class="line">		LL x, y;</div><div class="line">		in(x); in(y);</div><div class="line">		line[x][y] = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	FOR(i, <span class="number">1</span>, r) &#123;</div><div class="line">		FOR(j, <span class="number">1</span>, c) &#123;</div><div class="line">			<span class="keyword">if</span> (line[i][j] == <span class="number">0</span>) <span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">if</span> (j == <span class="number">1</span> || line[i][j - <span class="number">1</span>] == <span class="number">0</span>) lr[i][j] = <span class="number">0</span>;</div><div class="line">			<span class="keyword">else</span> lr[i][j] = lr[i][j - <span class="number">1</span>] + <span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">		DNF(j, c, <span class="number">1</span>) &#123;</div><div class="line">			<span class="keyword">if</span> (line[i][j] == <span class="number">0</span>) <span class="keyword">continue</span>;</div><div class="line">			<span class="keyword">if</span> (j == c || line[i][j + <span class="number">1</span>] == <span class="number">0</span>) lr[i][j] = <span class="number">0</span>;</div><div class="line">			<span class="keyword">else</span> chkmin(lr[i][j], lr[i][j + <span class="number">1</span>] + <span class="number">1</span>);</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		FOR(j, <span class="number">1</span>, c) <span class="keyword">if</span> (line[i][j]) &#123;</div><div class="line">			<span class="keyword">if</span> (i == <span class="number">1</span> || !line[i - <span class="number">1</span>][j]) tp[i][j] = <span class="number">0</span>;</div><div class="line">			<span class="keyword">else</span> tp[i][j] = tp[i - <span class="number">1</span>][j] + <span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	DNF(i, r, <span class="number">1</span>) &#123;</div><div class="line">		FOR(j, <span class="number">1</span>, c) <span class="keyword">if</span> (line[i][j]) &#123;</div><div class="line">			<span class="keyword">if</span> (i == r || !line[i + <span class="number">1</span>][j]) co[i][j] = <span class="number">0</span>;</div><div class="line">			<span class="keyword">else</span> co[i][j] = co[i + <span class="number">1</span>][j] + <span class="number">1</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	treap = <span class="literal">NULL</span>;</div><div class="line">	<span class="keyword">bool</span> is_cleared = <span class="literal">true</span>;</div><div class="line"></div><div class="line">	LL ans = <span class="number">0</span>;</div><div class="line">	</div><div class="line">	FOR(j, <span class="number">1</span>, c) &#123;</div><div class="line">		<span class="keyword">if</span> (!is_cleared) &#123;</div><div class="line">			treap -&gt; clear();</div><div class="line">			treap = <span class="literal">NULL</span>;</div><div class="line">			is_cleared = <span class="literal">true</span>;</div><div class="line">		&#125;</div><div class="line"></div><div class="line">		FOR(i, <span class="number">1</span>, r) &#123;</div><div class="line">			<span class="keyword">if</span> (i &gt; <span class="number">2</span>) &#123;</div><div class="line">				<span class="keyword">if</span> (lr[i - <span class="number">2</span>][j] != <span class="number">0</span> &amp;&amp; line[i - <span class="number">1</span>][j]) &#123;</div><div class="line">					treap -&gt; insert(lr[i - <span class="number">2</span>][j], tp[i - <span class="number">2</span>][j]);</div><div class="line">					is_cleared = <span class="literal">false</span>;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			</div><div class="line">			<span class="keyword">if</span> (!line[i][j]) &#123;</div><div class="line">				<span class="keyword">if</span> (!is_cleared) &#123;</div><div class="line">					treap -&gt; clear();</div><div class="line">					treap = <span class="literal">NULL</span>;</div><div class="line">					is_cleared = <span class="literal">true</span>;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">continue</span>;</div><div class="line">			&#125;</div><div class="line"></div><div class="line">			LL now = lr[i][j];</div><div class="line">			</div><div class="line">			<span class="keyword">if</span> (now &amp;&amp; treap != <span class="literal">NULL</span>) &#123;</div><div class="line">				LL rnk = treap -&gt; get_rnk(now);</div><div class="line">				<span class="keyword">if</span> (rnk != <span class="number">0</span>) &#123;</div><div class="line">					Node *hr;</div><div class="line">					<span class="keyword">if</span> (rnk != treap -&gt; sz) &#123;</div><div class="line">						treap -&gt; find_key(rnk + <span class="number">1</span>) -&gt; splay(<span class="literal">NULL</span>);</div><div class="line">						treap -&gt; find_key(rnk) -&gt; splay(treap);</div><div class="line">						hr = treap -&gt; ch[<span class="number">0</span>];</div><div class="line">					&#125;</div><div class="line">					<span class="keyword">else</span> &#123;</div><div class="line">						treap -&gt; find_key(rnk) -&gt; splay(<span class="literal">NULL</span>);</div><div class="line">						hr = treap;</div><div class="line">					&#125;</div><div class="line">					LL fst = hr -&gt; sum1 * now % MOD * co[i][j] % MOD;</div><div class="line">					LL sec = hr -&gt; sum2 * co[i][j] % MOD;</div><div class="line">					ans = (ans + fst - sec) % MOD;</div><div class="line">				&#125;</div><div class="line"></div><div class="line">				<span class="keyword">if</span> (rnk != treap -&gt; sz) &#123;</div><div class="line">					Node *hr;</div><div class="line">					<span class="keyword">if</span> (rnk != <span class="number">0</span>) &#123;</div><div class="line">						treap -&gt; find_key(rnk) -&gt; splay(<span class="literal">NULL</span>);</div><div class="line">						treap -&gt; find_key(rnk + <span class="number">1</span>) -&gt; splay(treap);</div><div class="line">						hr = treap -&gt; ch[<span class="number">1</span>];</div><div class="line">					&#125;</div><div class="line">					<span class="keyword">else</span> &#123;</div><div class="line">						treap -&gt; find_key(rnk + <span class="number">1</span>) -&gt; splay(<span class="literal">NULL</span>);</div><div class="line">						hr = treap;</div><div class="line">					&#125;</div><div class="line">					LL valu =</div><div class="line">						(now * now - now * (now + <span class="number">1</span>) / <span class="number">2</span>) * co[i][j] % MOD;</div><div class="line">					ans = (ans + hr -&gt; sum3 * valu % MOD) % MOD;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</div><div class="line">		</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="day1-t2-与非">Day1 T2 与非</h3>
<hr>
<h4 id="思路-1">思路</h4>
<p>首先可以发现一个性质——NAND操作可以构成所有的位运算，这个手玩一下就出来了。</p>
<p>然后对于二进制的某两位，我们发现如果对于每一个操作数，他们的这两位都相同，那么不论怎么运算最后肯定还是相同的。</p>
<p>除了这种限制之外，就没有其它限制了。</p>
<p>意思是说，如果在必定相同的两位之间连一条边，那么会形成一个个联通块。联通块与联通块之间两两对于答案的贡献是独立的。</p>
<p>联通块可以用并查集维护。</p>
<p>于是就可以答案进行数位DP辣！！</p>
<p>对于答案的第 <span class="math inline">\(i\)</span> 位，它的取值会影响一个联通块的取值。</p>
<p>我们从高到低地做，如果边界的该位上为 <span class="math inline">\(1\)</span>，那么我们取 <span class="math inline">\(0\)</span> 的话答案就要加上 <span class="math inline">\(2^p\)</span>，其中 <span class="math inline">\(p\)</span> 是尚未确定的联通块个数。</p>
<p>其余的类似。</p>
<hr>
<h4 id="代码-1">代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (int i = (a), i##_END_ = (b); i &lt;= i##_END_; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DNF(i, a, b) for (int i = (a), i##_END_ = (b); i &gt;= i##_END_; i--)</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">	<span class="keyword">char</span> ch = getchar(), f = <span class="number">1</span>; x = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (ch != <span class="string">'-'</span> &amp;&amp; (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>)) ch = getchar();</div><div class="line">	<span class="keyword">if</span> (ch == <span class="string">'-'</span>) f = <span class="number">-1</span>, ch = getchar();</div><div class="line">	<span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">	x *= f;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmax</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmin</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Max</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> LL MAXN = <span class="number">1010</span>;</div><div class="line"></div><div class="line">LL n, k, l, r, tot, A[MAXN], fa[MAXN];</div><div class="line"></div><div class="line"><span class="function">LL <span class="title">find</span><span class="params">(LL x)</span></span></div><div class="line">&#123;</div><div class="line">	LL tmp = x, pre;</div><div class="line">	<span class="keyword">while</span> (tmp != fa[tmp]) tmp = fa[tmp];</div><div class="line">	<span class="keyword">while</span> (x != tmp) pre = fa[x], fa[x] = tmp, x = pre;</div><div class="line">	<span class="keyword">return</span> tmp;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(LL x, LL y)</span></span></div><div class="line">&#123;</div><div class="line">	LL fx = find(x), fy = find(y);</div><div class="line">	<span class="keyword">if</span> (fx != fy) fa[fx] = fy;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">LL <span class="title">query</span><span class="params">(LL x)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> (x &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line"></div><div class="line">	LL ret = <span class="number">0</span>, tmp = tot;</div><div class="line">	<span class="keyword">static</span> <span class="keyword">bool</span> chose[<span class="number">100</span>];</div><div class="line">	<span class="keyword">static</span> <span class="keyword">bool</span> how_chose[<span class="number">100</span>];</div><div class="line"></div><div class="line">	<span class="built_in">memset</span>(chose, <span class="literal">false</span>, <span class="keyword">sizeof</span> chose);</div><div class="line"></div><div class="line">	<span class="keyword">if</span> (x &gt; (<span class="number">1l</span>l &lt;&lt; (k)) - <span class="number">1</span>) <span class="keyword">return</span> (<span class="number">1l</span>l &lt;&lt; tmp);</div><div class="line">	</div><div class="line">	DNF(i, k, <span class="number">1</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (!(x &amp; (<span class="number">1l</span>l &lt;&lt; (i - <span class="number">1</span>)))) &#123;</div><div class="line">			LL fx = find(i);</div><div class="line">			<span class="keyword">if</span> (chose[fx]) &#123;</div><div class="line">				<span class="keyword">if</span> (how_chose[fx] == <span class="number">1</span>) <span class="keyword">return</span> ret;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> &#123;</div><div class="line">				chose[fx] = <span class="literal">true</span>;</div><div class="line">				how_chose[fx] = <span class="number">0</span>;</div><div class="line">				tmp--;</div><div class="line">				<span class="keyword">continue</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> &#123;</div><div class="line">			LL fx = find(i);</div><div class="line">			<span class="keyword">if</span> (chose[fx]) &#123;</div><div class="line">				<span class="keyword">if</span> (how_chose[fx] == <span class="number">1</span>) <span class="keyword">continue</span>;</div><div class="line">				<span class="keyword">else</span> &#123;</div><div class="line">					ret += (<span class="number">1l</span>l &lt;&lt; tmp);</div><div class="line">					<span class="keyword">return</span> ret;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> &#123;</div><div class="line">				chose[fx] = <span class="literal">true</span>;</div><div class="line">				how_chose[fx] = <span class="number">1</span>;</div><div class="line">				tmp--;</div><div class="line">				ret += (<span class="number">1l</span>l &lt;&lt; tmp);</div><div class="line">				<span class="keyword">continue</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">return</span> ret + <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"nand.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"nand.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">	</div><div class="line">	in(n); in(k); in(l); in(r);</div><div class="line"></div><div class="line">	FOR(i, <span class="number">1</span>, n) in(A[i]);</div><div class="line"></div><div class="line">	FOR(i, <span class="number">1</span>, k) fa[i] = i;</div><div class="line">	</div><div class="line">	FOR(i, <span class="number">1</span>, k) &#123;</div><div class="line">		LL tmp = (<span class="number">1l</span>l &lt;&lt; (k)) - <span class="number">1</span>;</div><div class="line">		FOR(j, <span class="number">1</span>, n) &#123;</div><div class="line">			<span class="keyword">if</span> (A[j] &amp; (<span class="number">1l</span>l &lt;&lt; (i - <span class="number">1</span>))) &#123;</div><div class="line">				tmp &amp;= A[j];</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> tmp &amp;= (A[j] ^ ((<span class="number">1l</span>l &lt;&lt; k) - <span class="number">1</span>));</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span> (!(tmp &amp; (<span class="number">1l</span>l &lt;&lt; (i - <span class="number">1</span>)))) &#123;</div><div class="line">			<span class="built_in">puts</span>(<span class="string">"WA"</span>);</div><div class="line">		&#125;</div><div class="line">		FOR(j, <span class="number">1</span>, k) <span class="keyword">if</span> (j != i) &#123;</div><div class="line">			<span class="keyword">if</span> (<span class="keyword">bool</span>(tmp &amp; (<span class="number">1l</span>l &lt;&lt; (j - <span class="number">1</span>))) == <span class="keyword">bool</span>(tmp &amp; (<span class="number">1l</span>l &lt;&lt; (i - <span class="number">1</span>))))</div><div class="line">				merge(i, j);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	FOR(i, <span class="number">1</span>, k) <span class="keyword">if</span> (fa[i] == i) tot++;</div><div class="line"></div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, query(r) - query(l - <span class="number">1</span>));</div><div class="line"></div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="day1-t3-排队">Day1 T3 排队</h3>
<hr>
<h4 id="思路-2">思路</h4>
<p>首先放男同学，有 <span class="math inline">\(n!\)</span>。</p>
<p>然后放老师，可以放到一起或分开放，方案分别为 <span class="math inline">\(n!\times P_{n+1}^2\times P_{n+3}^m\)</span>，和 <span class="math inline">\(n!\times2(n+1)\)</span>。</p>
<p>最后放女同学。如果老师放在一起了，那么就要放一个女同学在老师中间；否则把老师看作男同学。</p>
<p>总方案为</p>
<p><span class="math display">\[n!\times(P_{n+1}^n\times P_{n+3}^m + 2(n+1)\times P_{n+2}^{m-1}\times m)\]</span></p>
<hr>
<h4 id="代码-2">代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> Max(x,y) ((x)&gt;(y)?(x):(y))</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> LL long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MOD 100000000</span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> bign&#123;</div><div class="line">	<span class="keyword">int</span> len;</div><div class="line">	LL s[<span class="number">10000</span>];</div><div class="line"></div><div class="line">	bign()&#123;</div><div class="line">		len=<span class="number">1</span>;</div><div class="line">		<span class="built_in">memset</span>(s,<span class="number">0</span>,<span class="keyword">sizeof</span> s); </div><div class="line">		s[<span class="number">1</span>]=<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	bign <span class="keyword">operator</span> = (<span class="keyword">const</span> LL &amp;num)&#123;</div><div class="line">		len=<span class="number">1</span>;</div><div class="line">		s[<span class="number">1</span>]=num;</div><div class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	bign <span class="keyword">operator</span> + (<span class="keyword">const</span> bign&amp;num)&#123;</div><div class="line">		bign c;c.s[<span class="number">1</span>]=<span class="number">0</span>;c.len=Max(num.len,len);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=c.len;i++)&#123;</div><div class="line">			c.s[i+<span class="number">1</span>]=(c.s[i]+s[i]+num.s[i])/MOD;</div><div class="line">			c.s[i]=(c.s[i]+s[i]+num.s[i])%MOD;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(c.s[c.len+<span class="number">1</span>])c.len++;</div><div class="line">		<span class="keyword">return</span> c;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	bign <span class="keyword">operator</span> - (<span class="keyword">const</span> bign&amp;num)&#123;</div><div class="line">		bign c;c.s[<span class="number">1</span>]=<span class="number">0</span>;c.len=len;</div><div class="line">		<span class="keyword">int</span> x=<span class="number">0</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=c.len;i++)&#123;</div><div class="line">			c.s[i]=s[i]-num.s[i]+x;</div><div class="line">			x=<span class="number">0</span>;</div><div class="line">			<span class="keyword">if</span>(c.s[i]&lt;<span class="number">0</span>)&#123;</div><div class="line">				c.s[i]+=MOD;</div><div class="line">				x=<span class="number">-1</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">while</span>(!c.s[c.len]&amp;&amp;c.len&gt;<span class="number">1</span>)c.len--;</div><div class="line">		<span class="keyword">return</span> c;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	bign <span class="keyword">operator</span> * (<span class="keyword">const</span> LL&amp;num)&#123;</div><div class="line">		bign c;c.s[<span class="number">1</span>]=<span class="number">0</span>;c.len=len;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=c.len;i++)&#123;</div><div class="line">			c.s[i+<span class="number">1</span>]=(c.s[i]+s[i]*num)/MOD;</div><div class="line">			c.s[i]=(c.s[i]+s[i]*num)%MOD;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(c.s[c.len+<span class="number">1</span>])c.len++;</div><div class="line">		<span class="keyword">return</span> c; </div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	bign <span class="keyword">operator</span> * (<span class="keyword">const</span> bign&amp;num)&#123;</div><div class="line">		bign c;c.s[<span class="number">1</span>]=<span class="number">0</span>;c.len=len+num.len+<span class="number">1</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=len;i++)</div><div class="line">			<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=num.len;j++)&#123;</div><div class="line">				c.s[i+j]+=(c.s[i+j<span class="number">-1</span>]+s[i]*num.s[j])/MOD;</div><div class="line">				c.s[i+j<span class="number">-1</span>]=(c.s[i+j<span class="number">-1</span>]+s[i]*num.s[j])%MOD;</div><div class="line">			&#125;</div><div class="line">		<span class="keyword">while</span>(!c.s[c.len]&amp;&amp;c.len&gt;<span class="number">1</span>)c.len--;</div><div class="line">		<span class="keyword">return</span> c;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">out</span><span class="params">()</span></span>&#123;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=len;i&gt;=<span class="number">1</span>;i--)&#123;</div><div class="line">			<span class="keyword">if</span>(i==len)<span class="built_in">printf</span>(<span class="string">"%lld"</span>,s[i]);</div><div class="line">			<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%08lld"</span>,s[i]);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"></div><div class="line">LL n,m,tmp,tmp2;</div><div class="line">bign ans1,ans2;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">	freopen(<span class="string">"queue.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"queue.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">	</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%lld%lld"</span>,&amp;n,&amp;m);tmp=n+<span class="number">4</span>;tmp2=n+<span class="number">3</span>;</div><div class="line">	<span class="keyword">for</span>(LL i=<span class="number">1</span>;i&lt;=n;i++)&#123;</div><div class="line">		ans1=ans1*i;</div><div class="line">		ans2=ans2*i;</div><div class="line">	&#125;</div><div class="line">	ans1=ans1*(n+<span class="number">1</span>)*n;</div><div class="line">	<span class="keyword">for</span>(LL i=<span class="number">1</span>;i&lt;=m&amp;&amp;tmp&gt;=<span class="number">0</span>;i++)&#123;</div><div class="line">		tmp--;</div><div class="line">		ans1=ans1*tmp;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(LL i=<span class="number">1</span>;i&lt;=m<span class="number">-1</span>&amp;&amp;tmp2&gt;=<span class="number">0</span>;i++)&#123;</div><div class="line">		tmp2--;</div><div class="line">		ans2=ans2*tmp2; </div><div class="line">	&#125;</div><div class="line">	ans2=ans2*<span class="number">2</span>*m*(n+<span class="number">1</span>);</div><div class="line">	(ans1+ans2).out(); </div><div class="line">	</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="day1-t4-矿场搭建">Day1 T4 矿场搭建</h3>
<hr>
<h4 id="思路-3">思路</h4>
<p>首先双联通缩点，然后对于每个联通块，只需要每个叶子节点放一个出口就行了（不能放割点）。</p>
<p>方案个数的话乘法原理就好了。</p>
<p>注意只有一个双联通分量的情况要特判！！</p>
<hr>
<h4 id="代码-3">代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"> </div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1010</span>, MAXM = <span class="number">510</span>;</div><div class="line"> </div><div class="line"><span class="keyword">bool</span> is[MAXN];</div><div class="line"><span class="keyword">int</span> belong[MAXN];</div><div class="line"><span class="keyword">int</span> dfn[MAXN], low[MAXN], INDEX, dot[MAXN], all, sz[MAXN];</div><div class="line"><span class="keyword">int</span> n, cnt, head[MAXN], nxt[MAXM &lt;&lt; <span class="number">1</span>], data[MAXM &lt;&lt; <span class="number">1</span>], du[MAXN];</div><div class="line"> </div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> ch = getchar(); x = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (ch != EOF &amp;&amp; (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>)) ch = getchar();</div><div class="line">    <span class="keyword">if</span> (ch == EOF) <span class="built_in">exit</span>(<span class="number">0</span>);</div><div class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">    nxt[cnt] = head[x]; data[cnt] = y; head[x] = cnt++;</div><div class="line">    nxt[cnt] = head[y]; data[cnt] = x; head[y] = cnt++;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> now, <span class="keyword">int</span> rot, <span class="keyword">int</span> fa)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> size = <span class="number">0</span>; <span class="keyword">bool</span> flag = <span class="literal">false</span>;</div><div class="line">    dfn[now] = low[now] = ++INDEX;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[now]; i != <span class="number">-1</span>; i = nxt[i]) </div><div class="line">        <span class="keyword">if</span> (!dfn[data[i]]) &#123;</div><div class="line">            size++;</div><div class="line">            dfs(data[i], rot, now);</div><div class="line">            low[now] = Min(low[now], low[data[i]]);</div><div class="line">            <span class="keyword">if</span> (low[data[i]] &gt;= dfn[now]) flag = <span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (data[i] != fa) &#123;</div><div class="line">            low[now] = Min(low[now], dfn[data[i]]);</div><div class="line">        &#125;</div><div class="line">    <span class="keyword">if</span> (flag &amp;&amp; (now != rot || size &gt;= <span class="number">2</span>)) &#123;</div><div class="line">        dot[++dot[<span class="number">0</span>]] = now;</div><div class="line">        is[now] = <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs2</span><span class="params">(<span class="keyword">int</span> now)</span> </span>&#123;</div><div class="line">    dfn[now] = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = head[now]; i != <span class="number">-1</span>; i = nxt[i])</div><div class="line">        <span class="keyword">if</span> (!is[data[i]] &amp;&amp; !dfn[data[i]]) &#123;</div><div class="line">            dfs2(data[i]);</div><div class="line">            sz[all]++;</div><div class="line">            belong[data[i]] = all;</div><div class="line">        &#125;</div><div class="line">&#125;</div><div class="line"> </div><div class="line"><span class="keyword">int</span> TTT;</div><div class="line"> </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	freopen(<span class="string">"mining.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"mining.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">	</div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">        in(n);</div><div class="line">        <span class="keyword">int</span> dian = <span class="number">-1</span>;</div><div class="line">        <span class="keyword">if</span> (!n) <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">        cnt = <span class="number">0</span>; all = <span class="number">0</span>;</div><div class="line">        <span class="built_in">memset</span>(du, <span class="number">0</span>, <span class="keyword">sizeof</span> du);</div><div class="line">        <span class="built_in">memset</span>(is, <span class="number">0</span>, <span class="keyword">sizeof</span> is);</div><div class="line">        <span class="built_in">memset</span>(dot, <span class="number">0</span>, <span class="keyword">sizeof</span> dot);</div><div class="line">        <span class="built_in">memset</span>(dfn, <span class="number">0</span>, <span class="keyword">sizeof</span> dfn);</div><div class="line">        <span class="built_in">memset</span>(low, <span class="number">0</span>, <span class="keyword">sizeof</span> low);</div><div class="line">        <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span> head);</div><div class="line">        <span class="built_in">memset</span>(belong, <span class="number">0</span>, <span class="keyword">sizeof</span> belong);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</div><div class="line">            <span class="keyword">int</span> s, t;</div><div class="line">            in(s); in(t); add(s, t);</div><div class="line">            dian = <span class="built_in">std</span>::max(dian, <span class="built_in">std</span>::max(s, t));</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dian; i++)</div><div class="line">            <span class="keyword">if</span> (!dfn[i]) dfs(i, i, <span class="number">-1</span>);</div><div class="line">        <span class="built_in">memset</span>(dfn, <span class="number">0</span>, <span class="keyword">sizeof</span> dfn);</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dian; i++)</div><div class="line">            <span class="keyword">if</span> (!dfn[i] &amp;&amp; !is[i]) &#123;</div><div class="line">                belong[i] = ++all;</div><div class="line">                sz[all] = <span class="number">1</span>;</div><div class="line">                dfs2(i);</div><div class="line">            &#125;</div><div class="line">        <span class="keyword">if</span> (all == <span class="number">1</span>) &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"Case %d: %d %d\n"</span>, ++TTT, <span class="number">2</span>, dian * (dian - <span class="number">1</span>) / <span class="number">2</span>);</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= dian; i++)</div><div class="line">            <span class="keyword">if</span> (is[i]) &#123;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = head[i]; j != <span class="number">-1</span>; j = nxt[j])</div><div class="line">                    dfn[belong[data[j]]] = <span class="number">0</span>;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = head[i]; j != <span class="number">-1</span>; j = nxt[j])</div><div class="line">                    <span class="keyword">if</span> (!dfn[belong[data[j]]]) &#123;</div><div class="line">                        dfn[belong[data[j]]] = <span class="literal">true</span>;</div><div class="line">                        du[belong[data[j]]]++;</div><div class="line">                    &#125;</div><div class="line">            &#125;</div><div class="line">        <span class="keyword">int</span> tot = <span class="number">0</span>;</div><div class="line">        <span class="keyword">long</span> <span class="keyword">long</span> fang = <span class="number">1</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= all; i++) &#123;</div><div class="line">            <span class="keyword">if</span> (du[i] == <span class="number">1</span>) &#123;</div><div class="line">                tot++;</div><div class="line">                <span class="keyword">if</span> (sz[i] &gt; <span class="number">1</span>)</div><div class="line">                    fang = fang * (sz[i]);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"Case %d: %d %lld\n"</span>, ++TTT, tot, fang);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="day2-t1">Day2 T1</h3>
<p>这是一道计算几何的题目。</p>
<p>因为我还没有进行这个专题，所以我跳过了这道题目。</p>
<hr>
<h3 id="day2-t2">Day2 T2</h3>
<p>这是一道计算几何的题目。</p>
<p>因为我还没有进行这个专题，所以我跳过了这道题目。</p>
<hr>
<h3 id="day2-t3">Day2 T3</h3>
<hr>
<h4 id="思路-4">思路</h4>
<p>这个题目是一道 <span class="math inline">\(splay\)</span> 的启发式合并的模板题。</p>
<p>只需要从小的合并到大的中间就可以了。</p>
<hr>
<h4 id="代码-4">代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (int i = (a), i##_END_ = (b); i &lt;= i##_END_; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DNF(i, a, b) for (int i = (a), i##_END_ = (b); i &gt;= i##_END_; i--)</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">	<span class="keyword">char</span> ch = getchar(); x = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>) ch = getchar();</div><div class="line">	<span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Max</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmax</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmin</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : x=y;&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100010</span>;</div><div class="line"></div><div class="line"><span class="keyword">char</span> command[<span class="number">10</span>];</div><div class="line"><span class="keyword">int</span> n, m, rnk[MAXN], fa[MAXN];</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node &#123;</div><div class="line">	<span class="keyword">int</span> data, sz, id;</div><div class="line">	Node *ch[<span class="number">2</span>], *fa;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(Node*)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">()</span></span>;</div><div class="line">	<span class="function">Node *<span class="title">find_key</span><span class="params">(<span class="keyword">int</span>)</span></span>;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(Node*)</span></span>;</div><div class="line">&#125; *to[MAXN];</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::rotate()</div><div class="line">&#123;</div><div class="line">	Node *pa = fa;</div><div class="line">	fa = pa -&gt; fa;</div><div class="line">	<span class="keyword">if</span> (fa != <span class="literal">NULL</span>) &#123;</div><div class="line">		<span class="keyword">bool</span> t = fa -&gt; ch[<span class="number">0</span>] == pa ? <span class="number">0</span> : <span class="number">1</span>;</div><div class="line">		fa -&gt; ch[t] = <span class="keyword">this</span>;</div><div class="line">	&#125;</div><div class="line">	pa -&gt; fa = <span class="keyword">this</span>;</div><div class="line">	<span class="keyword">bool</span> t = pa -&gt; ch[<span class="number">0</span>] == <span class="keyword">this</span> ? <span class="number">0</span> : <span class="number">1</span>;</div><div class="line">	Node *chd = ch[t ^ <span class="number">1</span>];</div><div class="line">	pa -&gt; ch[t] = chd;</div><div class="line">	<span class="keyword">if</span> (chd != <span class="literal">NULL</span>) chd -&gt; fa = pa;</div><div class="line">	ch[t ^ <span class="number">1</span>] = pa;</div><div class="line">	pa -&gt; update(); update();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::splay(Node *top)</div><div class="line">&#123;</div><div class="line">	<span class="keyword">while</span> (fa != top) &#123;</div><div class="line">		<span class="keyword">if</span> (fa -&gt; fa != top) &#123;</div><div class="line">			<span class="keyword">bool</span> t = (fa -&gt; ch[<span class="number">0</span>] == <span class="keyword">this</span> ? <span class="number">0</span> : <span class="number">1</span>);</div><div class="line">			<span class="keyword">if</span> (fa -&gt; fa -&gt; ch[t] == fa) &#123;</div><div class="line">				fa -&gt; rotate(); rotate();</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> rotate(), rotate();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> rotate();</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Node* Node::find_key(<span class="keyword">int</span> rnk)</div><div class="line">&#123;</div><div class="line">	Node *hr = <span class="keyword">this</span>;</div><div class="line">	<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</div><div class="line">		<span class="keyword">int</span> nowrnk;</div><div class="line">		nowrnk = (hr -&gt; ch[<span class="number">0</span>] == <span class="literal">NULL</span> ? <span class="number">1</span> : hr -&gt; ch[<span class="number">0</span>] -&gt; sz + <span class="number">1</span>);</div><div class="line">		<span class="keyword">if</span> (nowrnk == rnk) <span class="keyword">return</span> hr;</div><div class="line">		<span class="keyword">if</span> (nowrnk &lt;  rnk) &#123;</div><div class="line">			rnk -= nowrnk;</div><div class="line">			hr = hr -&gt; ch[<span class="number">1</span>];</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> hr = hr -&gt; ch[<span class="number">0</span>];</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::update()</div><div class="line">&#123;</div><div class="line">	sz = <span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span> (ch[<span class="number">0</span>] != <span class="literal">NULL</span>) sz += ch[<span class="number">0</span>] -&gt; sz;</div><div class="line">	<span class="keyword">if</span> (ch[<span class="number">1</span>] != <span class="literal">NULL</span>) sz += ch[<span class="number">1</span>] -&gt; sz;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::insert(Node *x)</div><div class="line">&#123;</div><div class="line">	<span class="keyword">bool</span> t;</div><div class="line">	Node *pos = <span class="keyword">this</span>, *pa = <span class="literal">NULL</span>;</div><div class="line">	<span class="keyword">while</span> (pos != <span class="literal">NULL</span>) &#123;</div><div class="line">		pa = pos;</div><div class="line">		<span class="keyword">if</span> (x -&gt; data &gt; pos -&gt; data) pos = pos -&gt; ch[<span class="number">1</span>], t = <span class="number">1</span>;</div><div class="line">		<span class="keyword">else</span> pos = pos -&gt; ch[<span class="number">0</span>], t = <span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	x -&gt; fa = pa;</div><div class="line">	<span class="keyword">if</span> (pa != <span class="literal">NULL</span>) pa -&gt; ch[t] = x;</div><div class="line">	x -&gt; ch[<span class="number">0</span>] = x -&gt; ch[<span class="number">1</span>] = <span class="literal">NULL</span>;</div><div class="line">	<span class="keyword">while</span> (x != <span class="literal">NULL</span>) &#123;</div><div class="line">		x -&gt; update();</div><div class="line">		x = x -&gt; fa;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Ins</span><span class="params">(Node* now, Node* to)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">if</span> (now == <span class="literal">NULL</span>) <span class="keyword">return</span>;</div><div class="line">	Ins(now -&gt; ch[<span class="number">0</span>], to); Ins(now -&gt; ch[<span class="number">1</span>], to);</div><div class="line">	to -&gt; splay(<span class="literal">NULL</span>); to -&gt; insert(now); now -&gt; splay(<span class="literal">NULL</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> tmp = x, pre;</div><div class="line">	<span class="keyword">while</span> (tmp != fa[tmp]) tmp = fa[tmp];</div><div class="line">	<span class="keyword">while</span> (x != tmp) pre = fa[x], fa[x] = tmp, x = pre;</div><div class="line">	<span class="keyword">return</span> tmp;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> fx = find(x), fy = find(y);</div><div class="line">	<span class="keyword">return</span> fx == fy ? <span class="literal">false</span> : fa[fx] = fy, <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"neverland.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"neverland.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">	</div><div class="line">	in(n); in(m);</div><div class="line">	FOR(i, <span class="number">1</span>, n) fa[i] = i;</div><div class="line">	FOR(i, <span class="number">1</span>, n) in(rnk[i]);</div><div class="line">	FOR(i, <span class="number">1</span>, n) &#123;</div><div class="line">		to[i] = <span class="keyword">new</span> Node;</div><div class="line">		to[i] -&gt; data = rnk[i];</div><div class="line">		to[i] -&gt; sz = <span class="number">1</span>; to[i] -&gt; id = i;</div><div class="line">		to[i] -&gt; fa = to[i] -&gt; ch[<span class="number">0</span>] = to[i] -&gt; ch[<span class="number">1</span>] = <span class="literal">NULL</span>;</div><div class="line">	&#125;</div><div class="line">	FOR(i, <span class="number">1</span>, m) &#123;</div><div class="line">		<span class="keyword">int</span> x, y; in(x); in(y);</div><div class="line">		<span class="keyword">if</span> (merge(x, y)) &#123;</div><div class="line">			<span class="keyword">if</span> (to[x] == <span class="literal">NULL</span>) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, x);</div><div class="line">			to[x] -&gt; splay(<span class="literal">NULL</span>);</div><div class="line">			to[y] -&gt; splay(<span class="literal">NULL</span>);</div><div class="line">			<span class="keyword">if</span> (to[x] -&gt; sz &lt; to[y] -&gt; sz) &#123;</div><div class="line">				Ins(to[x], to[y]);</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> Ins(to[y], to[x]);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">int</span> q; in(q);</div><div class="line"></div><div class="line">	<span class="keyword">while</span> (q--) &#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%s"</span>, command);</div><div class="line">		<span class="keyword">if</span> (command[<span class="number">0</span>] == <span class="string">'Q'</span>) &#123;</div><div class="line">			<span class="keyword">int</span> x, k;</div><div class="line">			in(x); in(k);</div><div class="line">			to[x] -&gt; splay(<span class="literal">NULL</span>);</div><div class="line">			<span class="keyword">if</span> (to[x] -&gt; sz &lt; k) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>);</div><div class="line">			<span class="keyword">else</span> &#123;</div><div class="line">				<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, to[x] -&gt; find_key(k) -&gt; id);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> &#123;</div><div class="line">			<span class="keyword">int</span> x, y;</div><div class="line">			in(x); in(y);</div><div class="line">			<span class="keyword">if</span> (merge(x, y)) &#123;</div><div class="line">				to[x] -&gt; splay(<span class="literal">NULL</span>);</div><div class="line">				to[y] -&gt; splay(<span class="literal">NULL</span>);</div><div class="line">				<span class="keyword">if</span> (to[x] -&gt; sz &lt; to[y] -&gt; sz) &#123;</div><div class="line">					Ins(to[x], to[y]);</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">else</span> Ins(to[y], to[x]);</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="day2-t4-集合选数">Day2 T4 集合选数</h3>
<hr>
<h4 id="思路-5">思路</h4>
<p>考虑一张表，将 <span class="math inline">\(1\)</span> 在左下角。</p>
<p>满足一个性质：对于一个格子，它的右边的格子里的数字是它的 <span class="math inline">\(3\)</span> 倍，上面的格子里的数字是它的 <span class="math inline">\(2\)</span> 倍。</p>
<p>于是问题转化为在格子中选不相邻的数的方案数。</p>
<p>表的长宽不会很大，是 <span class="math inline">\(log\)</span> 级别的。</p>
<p>可能有很多张不相交的表。</p>
<p>状压dp就好了。</p>
<hr>
<h4 id="代码-5">代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (register int i = (a), i##_END_ = (b); i &lt;= i##_END_; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DNF(i, a, b) for (register int i = (a), i##_END_ = (b); i &gt;= i##_END_; i--)</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">	<span class="keyword">char</span> ch = getchar(); x = <span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span> (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>) ch = getchar();</div><div class="line">	<span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Max</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmax</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmin</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : x=y;&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">1000000001</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100010</span>;</div><div class="line"></div><div class="line"><span class="keyword">bool</span> vis[MAXN];</div><div class="line"><span class="keyword">int</span> n, ans = <span class="number">1</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> <span class="built_in">map</span>[<span class="number">18</span>][<span class="number">18</span>], end[<span class="number">18</span>], f[<span class="number">2</span>][MAXN &lt;&lt; <span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> now)</span></span></div><div class="line">&#123;</div><div class="line">	<span class="keyword">int</span> ret = <span class="number">0</span>;</div><div class="line"></div><div class="line">	FOR(i, <span class="number">1</span>, <span class="number">100000</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (i == <span class="number">1</span>) <span class="built_in">map</span>[<span class="number">1</span>][i] = now;</div><div class="line">		<span class="keyword">else</span> <span class="built_in">map</span>[<span class="number">1</span>][i] = <span class="built_in">map</span>[<span class="number">1</span>][i - <span class="number">1</span>] * <span class="number">2</span>;</div><div class="line">		<span class="keyword">if</span> (<span class="built_in">map</span>[<span class="number">1</span>][i] &gt; n) &#123;</div><div class="line">			<span class="comment">//map[1][i] = -1;</span></div><div class="line">			<span class="keyword">break</span>;</div><div class="line">		&#125;</div><div class="line">		vis[<span class="built_in">map</span>[<span class="number">1</span>][i]] = <span class="literal">true</span>;</div><div class="line">		FOR(j, <span class="number">2</span>, <span class="number">100000</span>) &#123;</div><div class="line">			<span class="built_in">map</span>[j][i] = <span class="built_in">map</span>[j - <span class="number">1</span>][i] * <span class="number">3</span>;</div><div class="line">			<span class="keyword">if</span> (<span class="built_in">map</span>[j][i] &gt; n) &#123;</div><div class="line">				<span class="comment">//map[j][i] = -1;</span></div><div class="line">				<span class="keyword">break</span>;</div><div class="line">			&#125;</div><div class="line">			vis[<span class="built_in">map</span>[j][i]] = <span class="literal">true</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	end[<span class="number">0</span>] = <span class="number">0</span>;</div><div class="line"></div><div class="line">	<span class="keyword">bool</span> t = <span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> all = <span class="number">1</span>;</div><div class="line"></div><div class="line">	f[t ^ <span class="number">1</span>][<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line"></div><div class="line">	<span class="keyword">bool</span> first = <span class="literal">true</span>;</div><div class="line">	</div><div class="line">	FOR(i, <span class="number">1</span>, <span class="number">100000</span>) &#123;</div><div class="line">		<span class="keyword">if</span> (<span class="built_in">map</span>[i][<span class="number">1</span>] &lt;= n) &#123;</div><div class="line">			FOR(j, <span class="number">1</span>, <span class="number">100000</span>) <span class="keyword">if</span> (<span class="built_in">map</span>[i][j] &gt; n) &#123;end[i] = j - <span class="number">1</span>; <span class="keyword">break</span>;&#125;</div><div class="line">			<span class="keyword">int</span> limits1 = (<span class="number">1</span> &lt;&lt; end[i]) - <span class="number">1</span>, limits2 = (<span class="number">1</span> &lt;&lt; end[i - <span class="number">1</span>]) - <span class="number">1</span>;</div><div class="line">			FOR(j, <span class="number">0</span>, limits1) &#123;</div><div class="line">				f[t][j] = <span class="number">0</span>;</div><div class="line">				<span class="keyword">bool</span> flag = <span class="literal">true</span>;</div><div class="line">				<span class="keyword">if</span> (!first &amp;&amp; !f[t ^ <span class="number">1</span>][j]) <span class="keyword">continue</span>;</div><div class="line">				FOR(l, <span class="number">2</span>, end[i]) <span class="keyword">if</span> ((j &amp; (<span class="number">1</span> &lt;&lt; (l - <span class="number">1</span>))) &amp;&amp; (((j) &amp; (<span class="number">1</span> &lt;&lt; (l - <span class="number">2</span>))))) &#123;</div><div class="line">					flag = <span class="literal">false</span>;</div><div class="line">					<span class="keyword">break</span>;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span> (!flag) <span class="keyword">continue</span>;</div><div class="line">				FOR(k, <span class="number">0</span>, limits2) &#123;</div><div class="line">					<span class="keyword">bool</span> flag = <span class="literal">true</span>;</div><div class="line">					<span class="keyword">if</span> (!f[t ^ <span class="number">1</span>][k]) <span class="keyword">continue</span>;</div><div class="line">					FOR(l, <span class="number">1</span>, end[i]) &#123;</div><div class="line">						<span class="keyword">if</span> ((j &amp; (<span class="number">1</span> &lt;&lt; (l - <span class="number">1</span>))) &amp;&amp; (k &amp; (<span class="number">1</span> &lt;&lt; (l - <span class="number">1</span>)))) &#123;</div><div class="line">							flag = <span class="literal">false</span>;</div><div class="line">							<span class="keyword">break</span>;</div><div class="line">						&#125;</div><div class="line">					&#125;</div><div class="line">					<span class="keyword">if</span> (flag) f[t][j] = (f[t][j] + f[t ^ <span class="number">1</span>][k]) % MOD;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> &#123;</div><div class="line">			all = i - <span class="number">1</span>;</div><div class="line">			<span class="keyword">break</span>;</div><div class="line">		&#125;</div><div class="line">		first = <span class="literal">false</span>;</div><div class="line">		t ^= <span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	FOR(i, <span class="number">0</span>, (<span class="number">1</span> &lt;&lt; (end[all] - <span class="number">1</span>))) ret = (ret + f[t ^ <span class="number">1</span>][i]) % MOD;</div><div class="line">	</div><div class="line">	ans = <span class="number">1l</span>l * ans * ret % MOD;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">	freopen(<span class="string">"set.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">	freopen(<span class="string">"set.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">	</div><div class="line">	in(n);</div><div class="line">	FOR(i, <span class="number">1</span>, n) &#123;</div><div class="line">		<span class="keyword">if</span> (!vis[i]) solve(i);</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;hnoi2012解题报告&quot;&gt;HNOI2012解题报告&lt;/h2&gt;
&lt;h4 id=&quot;author-pengyihao&quot;&gt;Author: Pengyihao&lt;/h4&gt;
    
    </summary>
    
      <category term="HNOI" scheme="http://yoursite.com/categories/HNOI/"/>
    
    
      <category term="HNOI" scheme="http://yoursite.com/tags/HNOI/"/>
    
  </entry>
  
  <entry>
    <title>test20170401总结</title>
    <link href="http://yoursite.com/2017/04/02/test20170401%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2017/04/02/test20170401总结/</id>
    <published>2017-04-02T06:45:42.000Z</published>
    <updated>2017-04-02T07:00:02.607Z</updated>
    
    <content type="html"><![CDATA[<h2 id="test20170401总结">test20170401总结</h2>
<p>做题顺序：T1-&gt;T3-&gt;T2</p>
<a id="more"></a>
<hr>
<h4 id="t1">T1</h4>
<p>线性基的裸题。</p>
<p>直接求出最大值的排名，然后减掉1之后计算第 <span class="math inline">\(k\)</span> 大就行了。</p>
<p>期望得分：100分。</p>
<p>实际得分：100分。</p>
<hr>
<h4 id="t2">T2</h4>
<p>不会做，没有一点思路，暴力都不会……</p>
<p>超才竟然有dp的思路，真是太强了，%%%orzorz</p>
<p>期望得分：0</p>
<p>实际得分：0分。</p>
<hr>
<h4 id="t3">T3</h4>
<p>本来也是不会的。</p>
<p>研究了一下操作发现操作可逆。双向广搜？</p>
<p>想到ZJOI上有一个神犇曾经批判过我们盲目双向广搜，然后拿到题好像是把所有状态转移到同一个样子。</p>
<p>于是我就想能不能把 <span class="math inline">\(1\)</span> 往左移。</p>
<p>手玩了几发发现不管什么情况，都可以变成左边一连串 <span class="math inline">\(1\)</span>，一个<span class="math inline">\(0\)</span>，然后一个 <span class="math inline">\(1\)</span>，后面全是 <span class="math inline">\(0\)</span>；</p>
<p>或者左边一连串 <span class="math inline">\(1\)</span>，后面全是 <span class="math inline">\(0\)</span>。</p>
<p>然后发现对于中间间隔了一个 <span class="math inline">\(0\)</span> 的情况，<span class="math inline">\(1\)</span> 可以两个两个地增加。</p>
<p>对于左边全是 <span class="math inline">\(1\)</span> 的情况，<span class="math inline">\(1\)</span> 可以三个三个地增加。</p>
<p>……</p>
<p>于是只需要对于每个状态傻逼地往左移，</p>
<p>然后对于每个状态傻逼地往右扩展。</p>
<p>最后发现只有 <span class="math inline">\(5\)</span> 种情况（包括全 <span class="math inline">\(1\)</span>，<span class="math inline">\(0\)</span>）。</p>
<p>比较类别即可。</p>
<p>upd: 当 <span class="math inline">\(n\)</span> 很小的时候，因为舞台不够大，有一些移动不合法，所以要交暴力。我在 <span class="math inline">\(n\leq 5\)</span> 的时候是暴力跑的。</p>
<p>期望得分：100</p>
<p>实际得分：100分。</p>
<hr>
<h3 id="总结">总结</h3>
<p>思路有点局限？</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;test20170401总结&quot;&gt;test20170401总结&lt;/h2&gt;
&lt;p&gt;做题顺序：T1-&amp;gt;T3-&amp;gt;T2&lt;/p&gt;
    
    </summary>
    
      <category term="TEST" scheme="http://yoursite.com/categories/TEST/"/>
    
    
      <category term="TEST" scheme="http://yoursite.com/tags/TEST/"/>
    
  </entry>
  
  <entry>
    <title>test20170331总结</title>
    <link href="http://yoursite.com/2017/04/02/test20170331%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2017/04/02/test20170331总结/</id>
    <published>2017-04-02T06:37:53.000Z</published>
    <updated>2017-04-02T06:43:55.828Z</updated>
    
    <content type="html"><![CDATA[<h2 id="test20170331总结">test20170331总结</h2>
<p>做题顺序：T3-&gt;T1-&gt;T2</p>
<a id="more"></a>
<hr>
<h4 id="t1">T1</h4>
<p>不会做……</p>
<p>在打完第三题之后回来推了一会儿DP，结果并推不出什么，于是就交了一个暴力。</p>
<p>期望得分：30分。</p>
<p>实际得分：30分。</p>
<hr>
<h4 id="t2">T2</h4>
<p>考场上竟然没有想到！！</p>
<p>一看到题目，看到这么多限制条件，就想不是恶心dp就是网络流。</p>
<p>结果都做不了。于是就弃疗了。因为有分数，所以暴力也打不出。</p>
<p>考完之后谢超才和邱毓淞都看出了这题的本质——多重背包+二进制分组！！！</p>
<p>看来还是基础知识不杂实……</p>
<p>期望得分：0</p>
<p>实际得分：0分。</p>
<hr>
<h4 id="t3">T3</h4>
<p>一看到题目，发现是多次询问路径期望。</p>
<p>因为期望有线性性质，可以单独考虑每条边。</p>
<p>于是可以考虑<span class="math inline">\(f_i\)</span>表示从<span class="math inline">\(i\)</span>走到<span class="math inline">\(fa[i]\)</span>的期望步数，</p>
<p><span class="math inline">\(g_i\)</span>表示从<span class="math inline">\(fa[i]\)</span>走到<span class="math inline">\(i\)</span>的期望步数。</p>
<p>这个推一下公式就发现分母都被约掉了……</p>
<p>为了防止被卡精度，于是我打了long long加倍增。</p>
<p>期望得分：100</p>
<p>实际得分：100分。</p>
<hr>
<h3 id="总结">总结</h3>
<p>基础知识不够杂实。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;test20170331总结&quot;&gt;test20170331总结&lt;/h2&gt;
&lt;p&gt;做题顺序：T3-&amp;gt;T1-&amp;gt;T2&lt;/p&gt;
    
    </summary>
    
      <category term="TEST" scheme="http://yoursite.com/categories/TEST/"/>
    
    
      <category term="TEST" scheme="http://yoursite.com/tags/TEST/"/>
    
  </entry>
  
  <entry>
    <title>杜教筛</title>
    <link href="http://yoursite.com/2017/03/31/%E6%9D%9C%E6%95%99%E7%AD%9B/"/>
    <id>http://yoursite.com/2017/03/31/杜教筛/</id>
    <published>2017-03-31T03:56:07.000Z</published>
    <updated>2017-03-31T03:57:23.830Z</updated>
    
    <content type="html"><![CDATA[<p>若</p>
<p><span class="math display">\[h(n) = \sum_{i=1}^n f(i)\]</span></p>
<p>则有</p>
<p><span class="math display">\[h(n)=\sum_ {i=1}^{n}f(i)\lfloor \frac{n}{i}\rfloor-\sum_ {i=2}^{n}h(\lfloor \frac{n}{i}\rfloor)\]</span></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;若&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math display&quot;&gt;\[h(n) = \sum_{i=1}^n f(i)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;则有&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math display&quot;&gt;\[h(n)=\sum_ {i=1}^{n
    
    </summary>
    
      <category term="总结" scheme="http://yoursite.com/categories/%E6%80%BB%E7%BB%93/"/>
    
    
      <category term="总结" scheme="http://yoursite.com/tags/%E6%80%BB%E7%BB%93/"/>
    
  </entry>
  
  <entry>
    <title>test20170330总结</title>
    <link href="http://yoursite.com/2017/03/30/test20170330%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2017/03/30/test20170330总结/</id>
    <published>2017-03-30T01:43:33.000Z</published>
    <updated>2017-03-30T01:51:37.742Z</updated>
    
    <content type="html"><![CDATA[<h2 id="test20170330总结">test20170330总结</h2>
<p>做题顺序：T1-&gt;T2-&gt;T3</p>
<a id="more"></a>
<hr>
<h4 id="t1">T1</h4>
<p>一开始想了很久怎么让最后一次交易后变成 <span class="math inline">\(0\)</span>。</p>
<p>后来发现竟然不要输出买进了多少！！</p>
<p>所以如果最后一次交易后不为 <span class="math inline">\(0\)</span>，那么只需要在前面某一次买进操作中暗中减少一点进货就好了。</p>
<p>不知道怎么挂掉了？</p>
<p>期望得分：100分。</p>
<p>实际得分：90分。</p>
<hr>
<h4 id="t2">T2</h4>
<p>这就是一个经典的splay维护区间的问题。</p>
<p>一下子就打完了。</p>
<p>期望得分：100分。</p>
<p>实际得分：100分。</p>
<hr>
<h4 id="t3">T3</h4>
<p>不会做～</p>
<p>想了一个贪心，就是尽量从最低位选起，选到的火柴丢到最前面去，形成一串的11111111。</p>
<p>最后如果多出来一根火柴就在最高位凑一个7。</p>
<p>应该是对的，但是有一些特殊情况没有考虑（主要是因为时间不够了）。</p>
<p>期望得分：0+分。</p>
<p>实际得分：0分。</p>
<hr>
<h3 id="总结">总结</h3>
<p>做题要仔细……</p>
<p>最后一题连小数据都没有造……</p>
<p>我发现自己已经好久没有写过对拍了，下次考试一定要认真对拍……</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;test20170330总结&quot;&gt;test20170330总结&lt;/h2&gt;
&lt;p&gt;做题顺序：T1-&amp;gt;T2-&amp;gt;T3&lt;/p&gt;
    
    </summary>
    
      <category term="TEST" scheme="http://yoursite.com/categories/TEST/"/>
    
    
      <category term="TEST" scheme="http://yoursite.com/tags/TEST/"/>
    
  </entry>
  
  <entry>
    <title>test20170328总结</title>
    <link href="http://yoursite.com/2017/03/29/test20170328%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2017/03/29/test20170328总结/</id>
    <published>2017-03-29T02:28:00.000Z</published>
    <updated>2017-03-29T02:28:36.728Z</updated>
    
    <content type="html"><![CDATA[<h2 id="test20170328总结">test20170328总结</h2>
<p>做题顺序：T3-&gt;T2-&gt;T1</p>
<a id="more"></a>
<hr>
<h4 id="t1">T1</h4>
<p>看到这种题目就我脑袋痛……</p>
<p>第一眼看上去，我发现这是我一直做不出的一类题——不知道怎么在线段树中，将两个小区间合并成一个大区间。</p>
<p>按照以前的（错误）思路，我写了一个自认为很优的算法。</p>
<p>可是经过严格证明后，发现这是 <span class="math inline">\(O(n^2\log n)\)</span> 的。</p>
<p>然后我就弃疗了。</p>
<p>后来做了其它题之后，我回过头来，先从两个区间的情况推起。</p>
<p>然后发现了两个区间的做法好像可以推广到 <span class="math inline">\(k\)</span> 个区间的情况。</p>
<p>我的做法是 <span class="math inline">\(O(n\log n)\)</span> 的，但是常数有点大，有 <span class="math inline">\(105\)</span>。</p>
<p>果然被卡常了。</p>
<p>期望得分：100分。</p>
<p>实际得分：70分。</p>
<p>UPD：正解好像是“类似树分治的做法”？区间上为什么有树？</p>
<hr>
<h4 id="t2">T2</h4>
<p>感觉好像有印象，记得好像要转化成图论的问题。</p>
<p>结果推了半天没推出来什么东西……</p>
<p>打了一个暴力。</p>
<p>期望得分：40分。</p>
<p>实际得分：40分。</p>
<hr>
<h4 id="t3">T3</h4>
<p>并不会做，看到部分分最多就先打这题了。</p>
<p>用简单的树形dp就可以拿60分。</p>
<p>期望得分：60分。</p>
<p>实际得分：60分。</p>
<hr>
<h3 id="总结">总结</h3>
<p>讲过的题目竟然不记得了！！！</p>
<p>看来要及时总结和反思学过的内容，保证学过的内容都能熟练掌握！</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;test20170328总结&quot;&gt;test20170328总结&lt;/h2&gt;
&lt;p&gt;做题顺序：T3-&amp;gt;T2-&amp;gt;T1&lt;/p&gt;
    
    </summary>
    
      <category term="TEST" scheme="http://yoursite.com/categories/TEST/"/>
    
    
      <category term="TEST" scheme="http://yoursite.com/tags/TEST/"/>
    
  </entry>
  
  <entry>
    <title>HNOI2011解题报告</title>
    <link href="http://yoursite.com/2017/03/28/HNOI2011%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/"/>
    <id>http://yoursite.com/2017/03/28/HNOI2011解题报告/</id>
    <published>2017-03-28T02:57:37.000Z</published>
    <updated>2017-03-28T03:39:41.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="hnoi2011解题报告">HNOI2011解题报告</h2>
<h4 id="author-pengyihao">Author: Pengyihao</h4>
<a id="more"></a>
<hr>
<h3 id="day1-t1-数学作业">Day1 T1 数学作业</h3>
<hr>
<h4 id="题意">题意</h4>
<p>给出正整数 <span class="math inline">\(n\)</span>, <span class="math inline">\(m\)</span>，要求将 <span class="math inline">\(1-n\)</span> 这 <span class="math inline">\(n\)</span> 个数连接起来，问连接起来的数对 <span class="math inline">\(m\)</span> 取模的结果是多少。</p>
<p><span class="math inline">\(1\leq n\leq 10^{18}, 1\leq m\leq 10^9\)</span></p>
<h4 id="思路">思路</h4>
<p>如果连接的数的位数一样，那么可以用矩阵乘法进行优化。因为有 <span class="math display">\[nowans = lastans * 10^k + now\]</span></p>
<p>这个恒定的递推式（对于位数一样的数），所以可以分段矩阵乘法。</p>
<p>因为只有 <span class="math inline">\(lg(n)\)</span> 个位数，所以可以解决这个问题。</p>
<h4 id="代码">代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (LL i = (a), i##_END_ = (b); i &lt;= i##_END_; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> REP(i, a, b) for (LL i = (a), i##_END_ = (b); i &gt;= i##_END_; i--)</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> ch = getchar(); x = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>) ch = getchar();</div><div class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Max</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmax</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmin</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : x=y;&#125;</div><div class="line"></div><div class="line">LL n; LL m;</div><div class="line"></div><div class="line">LL ten[<span class="number">20</span>];</div><div class="line">LL tmpans;</div><div class="line"></div><div class="line">LL ret[<span class="number">4</span>][<span class="number">4</span>], tmp[<span class="number">4</span>][<span class="number">4</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(LL x[<span class="number">4</span>][<span class="number">4</span>], LL y[<span class="number">4</span>][<span class="number">4</span>], LL z[<span class="number">4</span>][<span class="number">4</span>])</span></span></div><div class="line">&#123;</div><div class="line">    LL t[<span class="number">4</span>][<span class="number">4</span>];</div><div class="line">    <span class="built_in">memset</span>(t, <span class="number">0</span>, <span class="keyword">sizeof</span> t);</div><div class="line">    FOR(i, <span class="number">1</span>, <span class="number">3</span>) FOR(j, <span class="number">1</span>, <span class="number">3</span>) FOR(k, <span class="number">1</span>, <span class="number">3</span>)</div><div class="line">        t[i][j] = (t[i][j] + <span class="number">1l</span>l * x[i][k] * y[k][j] % m) % m;</div><div class="line">    <span class="built_in">memcpy</span>(z, t, <span class="keyword">sizeof</span> t);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">work</span><span class="params">(LL x)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">bool</span> flagend = <span class="literal">false</span>;</div><div class="line">    LL ci = ten[x] - ten[x - <span class="number">1</span>], fr = ten[x - <span class="number">1</span>] % m;</div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (n &lt; ten[x]) &#123;</div><div class="line">        ci = n - ten[x - <span class="number">1</span>] + <span class="number">1</span>;</div><div class="line">        flagend = <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">memset</span>(ret, <span class="number">0</span>, <span class="keyword">sizeof</span> ret);</div><div class="line">    FOR(i, <span class="number">1</span>, <span class="number">3</span>) ret[i][i] = <span class="number">1</span>;</div><div class="line"></div><div class="line">    <span class="built_in">memset</span>(tmp, <span class="number">0</span>, <span class="keyword">sizeof</span> tmp);</div><div class="line">    tmp[<span class="number">1</span>][<span class="number">1</span>] = <span class="number">1</span>; tmp[<span class="number">1</span>][<span class="number">2</span>] = <span class="number">1</span>; tmp[<span class="number">2</span>][<span class="number">2</span>] = <span class="number">1</span>;</div><div class="line">    tmp[<span class="number">2</span>][<span class="number">3</span>] = <span class="number">1</span>; tmp[<span class="number">3</span>][<span class="number">3</span>] = ten[x] % m;</div><div class="line"></div><div class="line">    <span class="keyword">while</span> (ci) &#123;</div><div class="line">        <span class="keyword">if</span> (ci &amp; <span class="number">1</span>) mul(ret, tmp, ret);</div><div class="line">        mul(tmp, tmp, tmp);</div><div class="line">        ci &gt;&gt;= <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    tmpans = (</div><div class="line">        <span class="number">1l</span>l * ret[<span class="number">1</span>][<span class="number">3</span>] % m +</div><div class="line">        <span class="number">1l</span>l * fr * ret[<span class="number">2</span>][<span class="number">3</span>] % m +</div><div class="line">        <span class="number">1l</span>l * tmpans * ret[<span class="number">3</span>][<span class="number">3</span>] % m</div><div class="line">    ) % m;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (flagend) &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, tmpans);</div><div class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"homework.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">    freopen(<span class="string">"homework.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">    </div><div class="line">    in(n); in(m);</div><div class="line">    ten[<span class="number">0</span>] = <span class="number">1</span>;</div><div class="line">    FOR(i, <span class="number">1</span>, <span class="number">18</span>) ten[i] = ten[i - <span class="number">1</span>] * <span class="number">10</span>;</div><div class="line">    </div><div class="line">    FOR(i, <span class="number">1</span>, <span class="number">18</span>) <span class="keyword">if</span> (work(i)) <span class="keyword">break</span>;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="day1-t2-勾股定理">Day1 T2 勾股定理</h3>
<hr>
<p>这个题目有点问题，我在网上看题解的时候，发现这题的做法其实是不靠谱的，意思是说这是一道玄学的题目。</p>
<p>对于题目所给的数据范围，标程不一定都能在合理的时间内跑出答案。</p>
<p>所以我就跳过了这道题目。</p>
<hr>
<h3 id="day1-t3-赛车游戏">Day1 T3 赛车游戏</h3>
<hr>
<h4 id="思路-1">思路</h4>
<p>首先可以用拉格朗日乘数法证明，如果要达到最优成绩，那么每条路上的速度要尽可能相等。</p>
<p>于是就可以二分这个速度，然后计算耗油量。</p>
<p>注意如果某条路上耗油量为负数，那么就不能在这条路上用当前二分的速度来计算，因为可能耗油量为负数。</p>
<p>所以我们可以把这条路上的速度设置为令耗油量为0的速度。</p>
<p>这样就可以正确地计算耗油量和跑的时间了。</p>
<h4 id="代码-1">代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (int i = (a), i##_END_ = (b); i &lt;= i##_END_; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DNF(i, a, b) for (int i = (a), i##_END_ = (b); i &gt;= i##_END_; i--)</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> ch = getchar(); x = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>) ch = getchar();</div><div class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Max</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmax</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmin</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : x=y;&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">10010</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> T, n;</div><div class="line"><span class="keyword">double</span> a, b, vmax, f;</div><div class="line"><span class="keyword">double</span> s[MAXN], k[MAXN], sv[MAXN];</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> LIMITS = <span class="number">1000</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">double</span> <span class="title">check</span><span class="params">(<span class="keyword">double</span> _v)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">double</span> sum = <span class="number">0</span>;</div><div class="line">        </div><div class="line">    FOR(i, <span class="number">1</span>, n) &#123;</div><div class="line">        <span class="keyword">if</span> (_v &lt; sv[i]) &#123;</div><div class="line">            sum = sum + Max(<span class="number">0.</span>, a * sv[i] + b * k[i]) * s[i];</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> sum = sum + Max(<span class="number">0.</span>, a * _v + b * k[i]) * s[i];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> sum;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"race.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">    freopen(<span class="string">"race.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">    </div><div class="line">    in(T);</div><div class="line">    </div><div class="line">    <span class="keyword">while</span> (T--) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%lf%lf%lf%lf"</span>, &amp;a, &amp;b, &amp;vmax, &amp;f);</div><div class="line"></div><div class="line">        in(n);</div><div class="line">        FOR(i, <span class="number">1</span>, n) &#123;</div><div class="line">            <span class="keyword">double</span> x, y;</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%lf%lf"</span>, &amp;x, &amp;y);</div><div class="line">            x /= <span class="number">1000.0</span>; y /= <span class="number">1000.0</span>;</div><div class="line">            </div><div class="line">            s[i] = <span class="built_in">sqrt</span>(x * x + y * y);</div><div class="line">            k[i] = y / x;</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (k[i] &lt; <span class="number">0</span>) sv[i] = Min(-b * k[i] / a, vmax);</div><div class="line">            <span class="keyword">else</span> sv[i] = <span class="number">0</span>;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">double</span> l = <span class="number">0</span>, r = <span class="number">1000000000</span>;</div><div class="line">        </div><div class="line">        FOR(i, <span class="number">1</span>, LIMITS) &#123;</div><div class="line">            <span class="keyword">double</span> mid = (l + r) / <span class="number">2</span>;</div><div class="line">            <span class="keyword">if</span> (mid &gt; vmax || check(mid) &gt; f) r = mid;</div><div class="line">            <span class="keyword">else</span> l = mid;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (check(l) &gt; f) <span class="built_in">puts</span>(<span class="string">"IMPOSSIBLE"</span>);</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">double</span> ret = <span class="number">0</span>;</div><div class="line">            </div><div class="line">            FOR(i, <span class="number">1</span>, n) &#123;</div><div class="line">                <span class="keyword">if</span> (sv[i] &gt; l) ret += s[i] / sv[i];</div><div class="line">                <span class="keyword">else</span> ret += s[i] / l;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%.5lf\n"</span>, ret);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="day1-t4-括号修复">Day1 T4 括号修复</h3>
<hr>
<h4 id="思路-2">思路</h4>
<p>首先对于一个括号序列，如何计算它最少需要改多少个括号呢？</p>
<p>我们发现如果把可以匹配的括号一层一层去掉，那么最后一定会变成下面这个样子：</p>
<p>))))))))(((((((((</p>
<p>就是左边一连串的括号，右边一连串的括号。</p>
<p>假设左边有 <span class="math inline">\(l\)</span> 个括号，右边有 <span class="math inline">\(r\)</span> 个括号。</p>
<p>那么一共要改</p>
<p><span class="math display">\[\lfloor \frac{l+1}{2}\rfloor + \lfloor\frac{r+1}{2}\rfloor\]</span></p>
<p>个括号。</p>
<p>根据“维修数列”这一题的经验，我们可以用splay来维护括号序列。</p>
<p>用+1表示’(‘，用-1表示’)’，那么左边的括号数量就是从左开始的最小子段和，右边的括号数量就是从右开始的最大子段和。</p>
<p>操作1：直接打标记。</p>
<p>操作2：直接打标记。</p>
<p>操作3：变换一下从左开始的最小、最大子段和，从右开始的最小、最大子段和。</p>
<p>操作4：直接取值。</p>
<p>怎么合并标记呢？</p>
<p>当打区间赋值标记的时候，可以直接清空反转标记。</p>
<p>当打反转标记的时候，要将赋值标记乘上-1。</p>
<h4 id="代码-2">代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div><div class="line">312</div><div class="line">313</div><div class="line">314</div><div class="line">315</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (int i = (a), i##_END_ = (b); i &lt;= i##_END_; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DNF(i, a, b) for (int i = (a), i##_END_ = (b); i &gt;= i##_END_; i--)</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> ch = getchar(); x = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>) ch = getchar();</div><div class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Max</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmax</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmin</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : x=y;&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(Tp &amp;x, Tp &amp;y)</span> </span>&#123;Tp z = x; x = y; y = z;&#125;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node &#123;</div><div class="line">    <span class="keyword">bool</span> isa, ist_dn, isset;</div><div class="line">    </div><div class="line">    Node *ch[<span class="number">2</span>], *fa;</div><div class="line">    <span class="keyword">int</span> lmax, lmin, rmax, rmin, data, sum, sz, wt_set;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pushdown</span><span class="params">()</span></span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">()</span></span>;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">splay</span><span class="params">(Node*)</span></span>;</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">100010</span>;</div><div class="line"></div><div class="line">Node *nul, *rot, *to[MAXN];</div><div class="line"></div><div class="line"><span class="keyword">int</span> n, m;</div><div class="line"><span class="keyword">char</span> str[MAXN];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(Node *hr, Node *top)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (hr != nul) push(hr -&gt; fa, top);</div><div class="line">    <span class="keyword">if</span> (hr != nul) hr -&gt; pushdown();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::splay(Node *top)</div><div class="line">&#123;</div><div class="line">    push(<span class="keyword">this</span>, nul);</div><div class="line">    <span class="keyword">if</span> (ch[<span class="number">0</span>] != nul) ch[<span class="number">0</span>] -&gt; pushdown();</div><div class="line">    <span class="keyword">if</span> (ch[<span class="number">1</span>] != nul) ch[<span class="number">1</span>] -&gt; pushdown();</div><div class="line">    <span class="keyword">while</span> (fa != top) &#123;</div><div class="line">        <span class="keyword">if</span> (fa -&gt; fa != top) &#123;</div><div class="line">            <span class="keyword">bool</span> t = (fa -&gt; fa -&gt; ch[<span class="number">0</span>] == fa ? <span class="number">0</span> : <span class="number">1</span>);</div><div class="line">            <span class="keyword">if</span> (fa -&gt; ch[t] == <span class="keyword">this</span>) &#123;</div><div class="line">                fa -&gt; rotate(); rotate();</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span> rotate(), rotate();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> rotate();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (top == nul) rot = <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::rotate()</div><div class="line">&#123;</div><div class="line">    Node *pa = fa;</div><div class="line">    fa = pa -&gt; fa;</div><div class="line">    <span class="keyword">if</span> (fa != nul) &#123;</div><div class="line">        <span class="keyword">bool</span> t = (fa -&gt; ch[<span class="number">0</span>] == pa ? <span class="number">0</span> : <span class="number">1</span>);</div><div class="line">        fa -&gt; ch[t] = <span class="keyword">this</span>;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    pa -&gt; fa = <span class="keyword">this</span>;</div><div class="line">    </div><div class="line">    <span class="keyword">bool</span> t = (pa -&gt; ch[<span class="number">0</span>] == <span class="keyword">this</span> ? <span class="number">0</span> : <span class="number">1</span>);</div><div class="line">    </div><div class="line">    pa -&gt; ch[t] = ch[t ^ <span class="number">1</span>];</div><div class="line">    <span class="keyword">if</span> (ch[t ^ <span class="number">1</span>] != nul) ch[t ^ <span class="number">1</span>] -&gt; fa = pa;</div><div class="line"></div><div class="line">    ch[t ^ <span class="number">1</span>] = pa;</div><div class="line"></div><div class="line">    pa -&gt; update(); update();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::update()</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (ch[<span class="number">0</span>] != nul) ch[<span class="number">0</span>] -&gt; pushdown();</div><div class="line">    <span class="keyword">if</span> (ch[<span class="number">1</span>] != nul) ch[<span class="number">1</span>] -&gt; pushdown();</div><div class="line">    </div><div class="line">    sum = data; sz = <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> (ch[<span class="number">0</span>] != nul) sum += ch[<span class="number">0</span>] -&gt; sum, sz += ch[<span class="number">0</span>] -&gt; sz;</div><div class="line">    <span class="keyword">if</span> (ch[<span class="number">1</span>] != nul) sum += ch[<span class="number">1</span>] -&gt; sum, sz += ch[<span class="number">1</span>] -&gt; sz;</div><div class="line"></div><div class="line">    lmin = Min(<span class="number">0</span>, Min(ch[<span class="number">0</span>] -&gt; lmin, ch[<span class="number">0</span>] -&gt; sum + data + ch[<span class="number">1</span>] -&gt; lmin));</div><div class="line">    rmin = Min(<span class="number">0</span>, Min(ch[<span class="number">1</span>] -&gt; rmin, ch[<span class="number">1</span>] -&gt; sum + data + ch[<span class="number">0</span>] -&gt; rmin));</div><div class="line">    </div><div class="line">    lmax = Max(<span class="number">0</span>, Max(ch[<span class="number">0</span>] -&gt; lmax, ch[<span class="number">0</span>] -&gt; sum + data + ch[<span class="number">1</span>] -&gt; lmax));</div><div class="line">    rmax = Max(<span class="number">0</span>, Max(ch[<span class="number">1</span>] -&gt; rmax, ch[<span class="number">1</span>] -&gt; sum + data + ch[<span class="number">0</span>] -&gt; rmax));</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">void</span> Node::pushdown()</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (ist_dn) &#123;</div><div class="line">        ist_dn = <span class="literal">false</span>;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> tlmin = lmin, trmin = rmin;</div><div class="line">        <span class="keyword">int</span> tlmax = lmax, trmax = rmax;</div><div class="line"></div><div class="line">        data = -data; sum = -sum;</div><div class="line"> </div><div class="line">        lmin = -tlmax; lmax = -tlmin;</div><div class="line">        rmax = -trmin; rmin = -trmax;</div><div class="line"></div><div class="line">        wt_set = -wt_set;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">0</span>] != nul) &#123;</div><div class="line">            ch[<span class="number">0</span>] -&gt; ist_dn ^= <span class="number">1</span>;</div><div class="line"><span class="comment">//            if (ch[0] -&gt; isset)</span></div><div class="line"><span class="comment">//                ch[0] -&gt; wt_set = -ch[0] -&gt; wt_set;</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">1</span>] != nul) &#123;</div><div class="line">            ch[<span class="number">1</span>] -&gt; ist_dn ^= <span class="number">1</span>;</div><div class="line"><span class="comment">//            if (ch[1] -&gt; isset)</span></div><div class="line"><span class="comment">//                ch[1] -&gt; wt_set = -ch[1] -&gt; wt_set;</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (isset) &#123;</div><div class="line">        isset = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">0</span>] != nul)</div><div class="line">            ch[<span class="number">0</span>] -&gt; isset = <span class="literal">true</span>, ch[<span class="number">0</span>] -&gt; wt_set = wt_set, ch[<span class="number">0</span>] -&gt; ist_dn = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">1</span>] != nul)</div><div class="line">            ch[<span class="number">1</span>] -&gt; isset = <span class="literal">true</span>, ch[<span class="number">1</span>] -&gt; wt_set = wt_set, ch[<span class="number">1</span>] -&gt; ist_dn = <span class="literal">false</span>;</div><div class="line">        </div><div class="line">        data = wt_set; sum = wt_set * sz;</div><div class="line">        lmin = rmin = wt_set &lt; <span class="number">0</span> ? wt_set * sz : <span class="number">0</span>;</div><div class="line">        lmax = rmax = wt_set &gt; <span class="number">0</span> ? wt_set * sz : <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (isa) &#123;</div><div class="line">        isa = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">0</span>] != nul) ch[<span class="number">0</span>] -&gt; isa ^= <span class="number">1</span>;</div><div class="line">        <span class="keyword">if</span> (ch[<span class="number">1</span>] != nul) ch[<span class="number">1</span>] -&gt; isa ^= <span class="number">1</span>;</div><div class="line"></div><div class="line">        swap(lmin, rmin);</div><div class="line">        swap(lmax, rmax);</div><div class="line"></div><div class="line">        swap(ch[<span class="number">0</span>], ch[<span class="number">1</span>]);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">start</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    nul = <span class="keyword">new</span> Node;</div><div class="line"></div><div class="line">    nul -&gt; sz = <span class="number">0</span>;</div><div class="line">    nul -&gt; data = nul -&gt; sum = <span class="number">0</span>;</div><div class="line">    nul -&gt; isa = nul -&gt; ist_dn = nul -&gt; isset = <span class="literal">false</span>;</div><div class="line">    </div><div class="line">    nul -&gt; ch[<span class="number">0</span>] = nul -&gt; ch[<span class="number">1</span>] = nul -&gt; fa = nul;</div><div class="line">    </div><div class="line">    nul -&gt; lmax = nul -&gt; rmax = <span class="number">0</span>;</div><div class="line">    nul -&gt; lmin = nul -&gt; rmin = <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> now)</span></span></div><div class="line">&#123;</div><div class="line">    to[now] = <span class="keyword">new</span> Node;</div><div class="line">    <span class="keyword">if</span> (now == <span class="number">1</span>) rot = to[now];</div><div class="line"></div><div class="line">    to[now] -&gt; sz = <span class="number">1</span>;</div><div class="line">    to[now] -&gt; isa = to[now] -&gt; isset = to[now] -&gt; ist_dn = <span class="literal">false</span>;</div><div class="line">    </div><div class="line">    to[now] -&gt; ch[<span class="number">0</span>] = to[now] -&gt; ch[<span class="number">1</span>] = to[now] -&gt; fa = nul;</div><div class="line">    <span class="keyword">if</span> (now != <span class="number">1</span>) to[now] -&gt; fa = to[now - <span class="number">1</span>], to[now - <span class="number">1</span>] -&gt; ch[<span class="number">1</span>] = to[now];</div><div class="line"></div><div class="line">    to[now] -&gt; data = (str[now] == <span class="string">'('</span> ? <span class="number">1</span> : <span class="number">-1</span>);</div><div class="line">    to[now] -&gt; sum = to[now] -&gt; data;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">Node *<span class="title">find_key</span><span class="params">(<span class="keyword">int</span> rnk)</span></span></div><div class="line">&#123;</div><div class="line">    Node *x = rot;</div><div class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</div><div class="line">        x -&gt; pushdown();</div><div class="line">        <span class="keyword">int</span> rrnk = (x -&gt; ch[<span class="number">0</span>] == nul ? <span class="number">1</span> : x -&gt; ch[<span class="number">0</span>] -&gt; sz + <span class="number">1</span>);</div><div class="line">        <span class="keyword">if</span> (rrnk == rnk)</div><div class="line">            <span class="keyword">return</span> x;</div><div class="line">        <span class="keyword">if</span> (rrnk &gt;  rnk)</div><div class="line">            x = x -&gt; ch[<span class="number">0</span>];</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            x = x -&gt; ch[<span class="number">1</span>];</div><div class="line">            rnk -= rrnk;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">char</span> command[<span class="number">20</span>];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"brackets.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">    freopen(<span class="string">"brackets.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">    </div><div class="line">    in(n); in(m);</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, str + <span class="number">1</span>);</div><div class="line"></div><div class="line">    start();</div><div class="line">    </div><div class="line">    FOR(i, <span class="number">1</span>, n) insert(i);</div><div class="line"></div><div class="line">    DNF(i, n, <span class="number">1</span>) to[i] -&gt; update();</div><div class="line"></div><div class="line">    FOR(i, <span class="number">1</span>, m) &#123;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%s"</span>, command);</div><div class="line">        <span class="keyword">if</span> (command[<span class="number">0</span>] == <span class="string">'R'</span>) &#123;</div><div class="line">            <span class="keyword">int</span> x, y;</div><div class="line">            in(x); in(y);</div><div class="line">            <span class="built_in">scanf</span>(<span class="string">"%s"</span>, command);</div><div class="line">            Node *hr;</div><div class="line">            <span class="keyword">if</span> (x == <span class="number">1</span> &amp;&amp; y == n) hr = rot;</div><div class="line">            <span class="keyword">if</span> (x == <span class="number">1</span> &amp;&amp; y != n) &#123;</div><div class="line">                find_key(y + <span class="number">1</span>) -&gt; splay(nul);</div><div class="line">                hr = rot -&gt; ch[<span class="number">0</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (x != <span class="number">1</span> &amp;&amp; y == n) &#123;</div><div class="line">                find_key(x - <span class="number">1</span>) -&gt; splay(nul);</div><div class="line">                hr = rot -&gt; ch[<span class="number">1</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (x != <span class="number">1</span> &amp;&amp; y != n) &#123;</div><div class="line">                find_key(x - <span class="number">1</span>) -&gt; splay(nul);</div><div class="line">                find_key(y + <span class="number">1</span>) -&gt; splay(rot);</div><div class="line">                hr = find_key(y + <span class="number">1</span>) -&gt; ch[<span class="number">0</span>];</div><div class="line">            &#125;</div><div class="line">            hr -&gt; pushdown();</div><div class="line">            hr -&gt; ist_dn = <span class="literal">false</span>; hr -&gt; isset = <span class="literal">true</span>;</div><div class="line">            hr -&gt; wt_set = (command[<span class="number">0</span>] == <span class="string">'('</span> ? <span class="number">1</span> : <span class="number">-1</span>);</div><div class="line">            hr -&gt; pushdown();</div><div class="line">            <span class="keyword">while</span> (hr -&gt; fa != nul) &#123;</div><div class="line">                hr = hr -&gt; fa;</div><div class="line">                hr -&gt; update();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (command[<span class="number">0</span>] == <span class="string">'Q'</span>) &#123;</div><div class="line">            <span class="keyword">int</span> x, y;</div><div class="line">            in(x); in(y);</div><div class="line">            Node *hr;</div><div class="line">            <span class="keyword">if</span> (x == <span class="number">1</span> &amp;&amp; y == n) hr = rot;</div><div class="line">            <span class="keyword">if</span> (x == <span class="number">1</span> &amp;&amp; y != n) &#123;</div><div class="line">                find_key(y + <span class="number">1</span>) -&gt; splay(nul);</div><div class="line">                hr = rot -&gt; ch[<span class="number">0</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (x != <span class="number">1</span> &amp;&amp; y == n) &#123;</div><div class="line">                find_key(x - <span class="number">1</span>) -&gt; splay(nul);</div><div class="line">                hr = rot -&gt; ch[<span class="number">1</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (x != <span class="number">1</span> &amp;&amp; y != n) &#123;</div><div class="line">                find_key(x - <span class="number">1</span>) -&gt; splay(nul);</div><div class="line">                find_key(y + <span class="number">1</span>) -&gt; splay(rot);</div><div class="line">                hr = find_key(y + <span class="number">1</span>) -&gt; ch[<span class="number">0</span>];</div><div class="line">            &#125;</div><div class="line">            hr -&gt; pushdown();</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, (-(hr -&gt; lmin) + <span class="number">1</span>) / <span class="number">2</span> + (hr -&gt; rmax + <span class="number">1</span>) / <span class="number">2</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (command[<span class="number">0</span>] == <span class="string">'S'</span>) &#123;</div><div class="line">            <span class="keyword">int</span> x, y;</div><div class="line">            in(x); in(y);</div><div class="line">            Node *hr;</div><div class="line">            <span class="keyword">if</span> (x == <span class="number">1</span> &amp;&amp; y == n) hr = rot;</div><div class="line">            <span class="keyword">if</span> (x == <span class="number">1</span> &amp;&amp; y != n) &#123;</div><div class="line">                find_key(y + <span class="number">1</span>) -&gt; splay(nul);</div><div class="line">                hr = rot -&gt; ch[<span class="number">0</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (x != <span class="number">1</span> &amp;&amp; y == n) &#123;</div><div class="line">                find_key(x - <span class="number">1</span>) -&gt; splay(nul);</div><div class="line">                hr = rot -&gt; ch[<span class="number">1</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (x != <span class="number">1</span> &amp;&amp; y != n) &#123;</div><div class="line">                find_key(x - <span class="number">1</span>) -&gt; splay(nul);</div><div class="line">                find_key(y + <span class="number">1</span>) -&gt; splay(rot);</div><div class="line">                hr = find_key(y + <span class="number">1</span>) -&gt; ch[<span class="number">0</span>];</div><div class="line">            &#125;</div><div class="line">            hr -&gt; isa ^= <span class="number">1</span>;</div><div class="line">            hr -&gt; pushdown();</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (command[<span class="number">0</span>] == <span class="string">'I'</span>) &#123;</div><div class="line">            <span class="keyword">int</span> x, y;</div><div class="line">            in(x); in(y);</div><div class="line">            Node *hr;</div><div class="line">            <span class="keyword">if</span> (x == <span class="number">1</span> &amp;&amp; y == n) hr = rot;</div><div class="line">            <span class="keyword">if</span> (x == <span class="number">1</span> &amp;&amp; y != n) &#123;</div><div class="line">                find_key(y + <span class="number">1</span>) -&gt; splay(nul);</div><div class="line">                hr = rot -&gt; ch[<span class="number">0</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (x != <span class="number">1</span> &amp;&amp; y == n) &#123;</div><div class="line">                find_key(x - <span class="number">1</span>) -&gt; splay(nul);</div><div class="line">                hr = rot -&gt; ch[<span class="number">1</span>];</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (x != <span class="number">1</span> &amp;&amp; y != n) &#123;</div><div class="line">                find_key(x - <span class="number">1</span>) -&gt; splay(nul);</div><div class="line">                find_key(y + <span class="number">1</span>) -&gt; splay(rot);</div><div class="line">                hr = find_key(y + <span class="number">1</span>) -&gt; ch[<span class="number">0</span>];</div><div class="line">            &#125;</div><div class="line">            hr -&gt; ist_dn ^= <span class="number">1</span>;</div><div class="line">            hr -&gt; pushdown();</div><div class="line">            <span class="keyword">while</span> (hr -&gt; fa != nul) &#123;</div><div class="line">                hr = hr -&gt; fa;</div><div class="line">                hr -&gt; update();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="day2-t1-任务调度">Day2 T1 任务调度</h3>
<hr>
<p>这是一道随机出答案的题目，所以我没有做，直接跳过了。</p>
<hr>
<h3 id="day2-t2-xor和路径">Day2 T2 XOR和路径</h3>
<hr>
<h4 id="思路-3">思路</h4>
<p>这是一个简单的概率DP。</p>
<p>因为是XOR，所以我们可以逐位求出期望。</p>
<p>假设当前在处理第 <span class="math inline">\(k\)</span> 位，设 <span class="math inline">\(f[i]\)</span> 表示从 <span class="math inline">\(i\)</span> 到 <span class="math inline">\(n\)</span> 异或值为 <span class="math inline">\(1\)</span> 的概率。</p>
<p>则对于 <span class="math inline">\(i\)</span> 的一个连出去的边所指向的节点 <span class="math inline">\(j\)</span>，如果边权为 <span class="math inline">\(1\)</span>，则对 <span class="math inline">\(f[i]\)</span> 的贡献为</p>
<p><span class="math display">\[\frac{1-f[j]}{deg[i]}\]</span></p>
<p>如果边权为 <span class="math inline">\(0\)</span>，则对 <span class="math inline">\(f[i]\)</span> 的贡献为</p>
<p><span class="math display">\[\frac{f[j]}{deg[i]}\]</span></p>
<p>最后别忘了 <span class="math inline">\(f[n]=0\)</span>。</p>
<h4 id="代码-3">代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (int i = (a), i##_END_ = (b); i &lt;= i##_END_; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DNF(i, a, b) for (int i = (a), i##_END_ = (b); i &gt;= i##_END_; i--)</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> ch = getchar(); x = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>) ch = getchar();</div><div class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Max</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmax</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmin</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : x=y;&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">110</span>, MAXM = <span class="number">10010</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">double</span> eps = <span class="number">1e-8</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n, m, cnt, du[MAXN];</div><div class="line"><span class="keyword">int</span> head[MAXN], data[MAXM &lt;&lt; <span class="number">1</span>], nxt[MAXM &lt;&lt; <span class="number">1</span>], flow[MAXM &lt;&lt; <span class="number">1</span>];</div><div class="line"></div><div class="line"><span class="keyword">double</span> matrix[MAXN][MAXN];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span></span></div><div class="line">&#123;</div><div class="line">    nxt[cnt] = head[x]; data[cnt] = y; flow[cnt] = z; head[x] = cnt++;</div><div class="line">    <span class="keyword">if</span> (x != y) &#123;nxt[cnt] = head[y]; data[cnt] = x; flow[cnt] = z; head[y] = cnt++;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">gauss_george</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    FOR(i, <span class="number">1</span>, n) &#123;</div><div class="line">        <span class="keyword">double</span> maxv = <span class="number">-1</span>; <span class="keyword">int</span> maxq;</div><div class="line">        FOR(j, i, n) &#123;</div><div class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(matrix[j][i]) &gt; maxv) &#123;</div><div class="line">                maxv = <span class="built_in">fabs</span>(matrix[j][i]);</div><div class="line">                maxq = j;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(matrix[maxq][i] - maxv) &gt; eps) &#123;</div><div class="line">            assert(<span class="number">0</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">fabs</span>(matrix[maxq][i]) &lt; eps) <span class="keyword">continue</span>;</div><div class="line">        </div><div class="line">        FOR(j, <span class="number">1</span>, n + <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">double</span> tmp = matrix[i][j];</div><div class="line">            matrix[i][j] = matrix[maxq][j];</div><div class="line">            matrix[maxq][j] = tmp;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">double</span> chu = matrix[i][i];</div><div class="line">        FOR(j, <span class="number">1</span>, n + <span class="number">1</span>) matrix[i][j] /= chu;</div><div class="line"></div><div class="line">        FOR(j, <span class="number">1</span>, n) &#123;</div><div class="line">            <span class="keyword">if</span> (j != i) &#123;</div><div class="line">                <span class="keyword">if</span> (<span class="built_in">fabs</span>(matrix[j][i]) &lt; eps) <span class="keyword">continue</span>;</div><div class="line">                <span class="keyword">double</span> chu = matrix[j][i];</div><div class="line">                FOR(k, <span class="number">1</span>, n + <span class="number">1</span>)</div><div class="line">                    matrix[j][k] -= matrix[i][k] * chu;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"xor.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">    freopen(<span class="string">"xor.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">    </div><div class="line">    in(n); in(m);</div><div class="line"></div><div class="line">    <span class="built_in">memset</span>(head, <span class="number">-1</span>, <span class="keyword">sizeof</span> head);</div><div class="line">    </div><div class="line">    FOR(i, <span class="number">1</span>, m) &#123;</div><div class="line">        <span class="keyword">int</span> u, v, w;</div><div class="line">        in(u); in(v); in(w);</div><div class="line"></div><div class="line">        add(u, v, w);</div><div class="line">        du[v]++; <span class="keyword">if</span> (u != v) du[u]++;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">double</span> ans = <span class="number">0</span>;</div><div class="line">    </div><div class="line">    FOR(i, <span class="number">1</span>, <span class="number">31</span>) &#123;</div><div class="line">        <span class="built_in">memset</span>(matrix, <span class="number">0</span>, <span class="keyword">sizeof</span> matrix);</div><div class="line">        FOR(j, <span class="number">1</span>, n - <span class="number">1</span>) &#123;</div><div class="line">            matrix[j][j] = du[j];</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = head[j]; k != <span class="number">-1</span>; k = nxt[k]) &#123;</div><div class="line">                <span class="keyword">if</span> (flow[k] &amp; (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>))) &#123;</div><div class="line">                    matrix[j][data[k]] += <span class="number">1.0</span>;</div><div class="line">                    matrix[j][n + <span class="number">1</span>] += <span class="number">1.0</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">else</span></div><div class="line">                    matrix[j][data[k]] -= <span class="number">1.0</span>;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        matrix[n][n] = <span class="number">1</span>;</div><div class="line">        gauss_george();</div><div class="line">        ans += (<span class="number">1</span> &lt;&lt; (i - <span class="number">1</span>)) * matrix[<span class="number">1</span>][n + <span class="number">1</span>] / matrix[<span class="number">1</span>][<span class="number">1</span>];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%.3lf\n"</span>, ans);</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="day2-t3-数矩形">Day2 T3 数矩形</h3>
<hr>
<h4 id="思路-4">思路</h4>
<p>这又是一道玄学题。</p>
<p>我们找到每条线段的中点，然后按照中点为第一关键字，线段的长度为第二关键字进行排序。</p>
<p>然后对于每个线段，暴力找前面所有跟它中点重合且长度相等的线段……</p>
<p>这样就可以过了。</p>
<h4 id="代码-4">代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (int i = (a), i##_END_ = (b); i &lt;= i##_END_; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DNF(i, a, b) for (int i = (a), i##_END_ = (b); i &gt;= i##_END_; i--)</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> ch = getchar(), f = <span class="number">1</span>; x = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (ch != <span class="string">'-'</span> &amp;&amp; (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>)) ch = getchar();</div><div class="line">    <span class="keyword">if</span> (ch == <span class="string">'-'</span>) ch = getchar(), f = <span class="number">-1</span>;</div><div class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">    x *= f;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Max</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmax</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmin</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : x=y;&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">2010</span>;</div><div class="line"></div><div class="line"><span class="keyword">struct</span> Node &#123;</div><div class="line">    LL lenth;</div><div class="line">    <span class="keyword">int</span> posx, posy, rposx[<span class="number">2</span>], rposy[<span class="number">2</span>];</div><div class="line">&#125; pos[MAXN * MAXN];</div><div class="line"></div><div class="line"><span class="keyword">int</span> n, cnt, x[MAXN], y[MAXN];</div><div class="line"></div><div class="line"><span class="function">LL <span class="title">two</span><span class="params">(LL x)</span> </span>&#123;<span class="keyword">return</span> x * x;&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">cmp</span><span class="params">(<span class="keyword">const</span> Node &amp;x, <span class="keyword">const</span> Node &amp;y)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">bool</span> t1 = x.posx &lt; y.posx;</div><div class="line">    <span class="keyword">bool</span> t2 = x.posx == y.posx &amp;&amp; x.posy &lt; y.posy;</div><div class="line">    <span class="keyword">bool</span> t3 = x.posx == y.posx &amp;&amp; x.posy == y.posy &amp;&amp; x.lenth &lt; y.lenth;</div><div class="line">    <span class="keyword">return</span> t1 || t2 || t3;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function">LL <span class="title">abs</span><span class="params">(LL x)</span> </span>&#123;<span class="keyword">return</span> x &gt; <span class="number">0</span> ? x : -x;&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"rectangle.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">    freopen(<span class="string">"rectangle.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">    </div><div class="line">    in(n);</div><div class="line"></div><div class="line">    FOR(i, <span class="number">1</span>, n) &#123;</div><div class="line">        in(x[i]); in(y[i]);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    FOR(i, <span class="number">1</span>, n) FOR(j, i + <span class="number">1</span>, n) &#123;</div><div class="line">        pos[++cnt].posx = x[i] + x[j], pos[cnt].posy = y[i] + y[j];</div><div class="line">        pos[cnt].lenth = two(x[i] - x[j]) + two(y[i] - y[j]);</div><div class="line">        pos[cnt].rposx[<span class="number">0</span>] = x[i]; pos[cnt].rposx[<span class="number">1</span>] = x[j];</div><div class="line">        pos[cnt].rposy[<span class="number">0</span>] = y[i]; pos[cnt].rposy[<span class="number">1</span>] = y[j];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">std</span>::sort(pos + <span class="number">1</span>, pos + cnt + <span class="number">1</span>, cmp);</div><div class="line"></div><div class="line">    LL ans = <span class="number">-1</span>;</div><div class="line">    </div><div class="line">    FOR(i, <span class="number">1</span>, cnt) &#123;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>;</div><div class="line">             j &gt;= <span class="number">1</span> &amp;&amp; pos[j].lenth == pos[i].lenth</div><div class="line">                 &amp;&amp; pos[i].posx == pos[j].posx &amp;&amp; pos[i].posy == pos[j].posy;</div><div class="line">             j--)</div><div class="line">            chkmax(ans,</div><div class="line">                   <span class="built_in">abs</span>(<span class="number">2l</span>l * pos[i].rposx[<span class="number">0</span>] * pos[j].rposy[<span class="number">0</span>] - <span class="number">2l</span>l * pos[i].rposy[<span class="number">0</span>] * pos[j].rposx[<span class="number">0</span>]</div><div class="line">                   + <span class="number">1l</span>l * pos[j].rposx[<span class="number">0</span>] * pos[i].posy - <span class="number">1l</span>l * pos[j].rposy[<span class="number">0</span>] * pos[i].posx</div><div class="line">                       + <span class="number">1l</span>l * pos[i].posx * pos[i].rposy[<span class="number">0</span>] - <span class="number">1l</span>l * pos[i].posy * pos[i].rposx[<span class="number">0</span>]));</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h3 id="day2-t4-卡农">Day2 T4 卡农</h3>
<hr>
<h4 id="思路-5">思路</h4>
<p>我们可以先算出可以记片段之间顺序的方案数，因为两两不同，所以最后除以 <span class="math inline">\(m!\)</span> 就可以了。</p>
<p>设 <span class="math inline">\(f[i]\)</span> 表示前 <span class="math inline">\(i\)</span> 个片段满足题意的方案数。</p>
<p>如果前 <span class="math inline">\(i-1\)</span> 个片段已经决定了，那么第 <span class="math inline">\(i\)</span> 个片段也可以由奇偶关系决定了。</p>
<p>那么答案就为 <span class="math inline">\(P(2^n-1, i-1)\)</span> 减去不合法的方案。</p>
<p>这里的 <span class="math inline">\(P(2^n-1, i-1)\)</span> 可以递推求。</p>
<p>不合法的方案只有两种可能：</p>
<ol style="list-style-type: decimal">
<li><p>前 <span class="math inline">\(i-1\)</span> 个片段已经满足偶数要求了，那么第 <span class="math inline">\(i\)</span> 个片段必须是空集合，不符合规定。 所以要减去 <span class="math inline">\(f[i-1]\)</span>。</p></li>
<li><p>被决定出来的第 <span class="math inline">\(i\)</span> 个片段重复了。 那么与它重复的那个片段有 <span class="math inline">\(i-1\)</span> 个位置可以选择。 并且如果除了这两个片段之外，其它的片段均满足偶数条件，那么这两个片段一定相同。 而这个片段本身也有 <span class="math inline">\(2^n-1-(i-2)\)</span> 种可能。 所以要减去 <span class="math inline">\(f[i-2]\times (i-1)\times (2^n-1-(i-2))\)</span></p></li>
</ol>
<p>所以就可以直接求了。</p>
<h4 id="代码-5">代码</h4>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (int i = (a), i##_END_ = (b); i &lt;= i##_END_; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DNF(i, a, b) for (int i = (a), i##_END_ = (b); i &gt;= i##_END_; i--)</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> ch = getchar(); x = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>) ch = getchar();</div><div class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Max</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmax</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmin</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : x=y;&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MOD = <span class="number">100000007</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">1000010</span>;</div><div class="line"></div><div class="line"><span class="keyword">int</span> n, m;</div><div class="line">LL f[MAXN];</div><div class="line"></div><div class="line"><span class="function">LL <span class="title">power</span><span class="params">(LL x, LL y)</span></span></div><div class="line">&#123;</div><div class="line">    LL ret = <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (y) &#123;</div><div class="line">        <span class="keyword">if</span> (y &amp; <span class="number">1</span>) ret = ret * x % MOD;</div><div class="line">        x = x * x % MOD;</div><div class="line">        y &gt;&gt;= <span class="number">1</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    freopen(<span class="string">"canon.in"</span>, <span class="string">"r"</span>, <span class="built_in">stdin</span>);</div><div class="line">    freopen(<span class="string">"canon.out"</span>, <span class="string">"w"</span>, <span class="built_in">stdout</span>);</div><div class="line">    </div><div class="line">    in(n); in(m);</div><div class="line"></div><div class="line">    LL pre = <span class="number">1</span>, po = (power(<span class="number">2</span>, n) - <span class="number">1</span> + MOD) % MOD;</div><div class="line"></div><div class="line">    pre = pre * po % MOD;</div><div class="line">    po = (po - <span class="number">1</span> + MOD) % MOD;</div><div class="line"></div><div class="line">    f[<span class="number">0</span>] = <span class="number">1</span>; f[<span class="number">1</span>] = <span class="number">0</span>;</div><div class="line"></div><div class="line">    FOR(i, <span class="number">2</span>, m) &#123;</div><div class="line">        f[i] = pre;</div><div class="line">        f[i] = (f[i] - f[i - <span class="number">1</span>] + MOD) % MOD;</div><div class="line">        f[i] = (f[i] - f[i - <span class="number">2</span>] * (i - <span class="number">1</span>) % MOD * (power(<span class="number">2</span>, n) - <span class="number">1</span> - (i - <span class="number">2</span>)) % MOD + MOD) % MOD;</div><div class="line">        pre = pre * po % MOD;</div><div class="line">        po = (po - <span class="number">1</span> + MOD) % MOD;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    LL ret = <span class="number">1</span>; FOR(i, <span class="number">1</span>, m) ret = ret * i % MOD;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, f[m] * power(ret, MOD - <span class="number">2</span>) % MOD);</div><div class="line">    </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;hnoi2011解题报告&quot;&gt;HNOI2011解题报告&lt;/h2&gt;
&lt;h4 id=&quot;author-pengyihao&quot;&gt;Author: Pengyihao&lt;/h4&gt;
    
    </summary>
    
      <category term="HNOI" scheme="http://yoursite.com/categories/HNOI/"/>
    
    
      <category term="HNOI" scheme="http://yoursite.com/tags/HNOI/"/>
    
  </entry>
  
  <entry>
    <title>test20170326总结</title>
    <link href="http://yoursite.com/2017/03/26/test20170326%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2017/03/26/test20170326总结/</id>
    <published>2017-03-26T12:20:19.000Z</published>
    <updated>2017-03-26T12:30:46.625Z</updated>
    
    <content type="html"><![CDATA[<h2 id="test20170326总结">test20170326总结</h2>
<p>做题顺序：T2-&gt;T3-&gt;T1</p>
<a id="more"></a>
<hr>
<h4 id="t1">T1</h4>
<p>这个题目很复杂，第一眼看过去就知道我做不出来。</p>
<p>因为概率题做得少，所以直接跳过了。</p>
<p>打了一个树的表，结果没得分（严重怀疑数据有问题）。</p>
<p>期望得分：10分。</p>
<p>实际得分：0分。</p>
<hr>
<h4 id="t2">T2</h4>
<p>垃圾题目，大组合数套BSGS，代码300+行。</p>
<p>结果因为一处没取模+没有手写hash用了map替代，结果被卡掉了，只有50分。</p>
<p>期望得分：100分。</p>
<p>实际得分：50分。</p>
<hr>
<h4 id="t3">T3</h4>
<p>这个题目应该是线段树加速dp。</p>
<p>考场上没有想清，打了很久，最后打挂了。</p>
<p>最后只交了暴力。</p>
<blockquote><p>线段树打两个标记不就可以$O(n\log ^2n)$了吗？</p>
<footer><strong>Xie Chaocai</strong><cite>一个神犇</cite></footer></blockquote>
<p>感觉好有道理。</p>
<p>期望得分：30分。</p>
<p>实际得分：30分。</p>
<hr>
<h3 id="总结">总结</h3>
<p>考场上太过于紧张，思路不清晰，浪费了大量的时间。</p>
<p>没有压行技巧，导致代码过长，难以调试和对拍。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;test20170326总结&quot;&gt;test20170326总结&lt;/h2&gt;
&lt;p&gt;做题顺序：T2-&amp;gt;T3-&amp;gt;T1&lt;/p&gt;
    
    </summary>
    
      <category term="TEST" scheme="http://yoursite.com/categories/TEST/"/>
    
    
      <category term="TEST" scheme="http://yoursite.com/tags/TEST/"/>
    
  </entry>
  
  <entry>
    <title>codeforces235E</title>
    <link href="http://yoursite.com/2017/03/25/codeforces235E/"/>
    <id>http://yoursite.com/2017/03/25/codeforces235E/</id>
    <published>2017-03-25T11:50:10.000Z</published>
    <updated>2017-03-30T04:30:13.561Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题意">题意</h2>
<hr>
<p>求</p>
<p><span class="math display">\[\sum_{i=1}^a\sum_{j=1}^b\sum_{k=1}^cd(ijk)\]</span></p>
<p>其中，<span class="math inline">\(d(i)\)</span> 表示 <span class="math inline">\(i\)</span> 的约数个数。</p>
<p><span class="math inline">\(a, b, c\leq 2000\)</span></p>
<hr>
<a id="more"></a>
<h2 id="solution">Solution</h2>
<p>设</p>
<p><span class="math display">\[f(i)=\sum_{j=1}^a\sum_{k=1}^b[j\times k == i]\]</span></p>
<p>则</p>
\begin{align}
&amp;\sum_{i=1}^a\sum_{j=1}^b\sum_{k=1}^cd(ijk) \\
=&amp;\sum_{i=1}^{ab}f(i)\times \sum_{j=1}^cd(ij) \\
=&amp;\sum_{i=1}^{ab}f(i)\times \sum_{j=1}^c\sum_{u|i}\sum_{v|j}[(u,v)==1] \\
=&amp;\sum_{u=1}^{ab}\sum_{v=1}^c[(u,v)==1]\sum_{u|i}^{ab}\times f(i)\times \lfloor \frac{c}{v}\rfloor \\
=&amp;\sum_{u=1}^{ab}\sum_{d|u}\mu(d)\times \sum_{d|v}\lfloor \frac{c}{v}\rfloor\times \sum_{u|i}^{ab}\times f(i) \\
\end{align}
<p>然后我们发现全部都可以预处理出来！！！</p>
<p>因为这些枚举倍数的部分都是独立的，而且单单枚举倍数是可以做到<span class="math inline">\(O(n\log n)\)</span>的。</p>
<p>所以时间复杂度就为<span class="math inline">\(O(ab\log ab)\)</span>了，要卡常！</p>
<hr>
<h2 id="code">Code</h2>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (int i = (a), i##_END_ = (b); i &lt;= i##_END_; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DNF(i, a, b) for (int i = (a), i##_END_ = (b); i &gt;= i##_END_; i--)</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> ch = getchar(); x = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>) ch = getchar();</div><div class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmax</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmin</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Max</span><span class="params">(<span class="keyword">const</span> Tp &amp;x, <span class="keyword">const</span> Tp &amp;y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(<span class="keyword">const</span> Tp &amp;x, <span class="keyword">const</span> Tp &amp;y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXN = <span class="number">4000010</span>, MOD = (<span class="number">1</span> &lt;&lt; <span class="number">30</span>);</div><div class="line"></div><div class="line"><span class="keyword">int</span> a, b, c;</div><div class="line"><span class="keyword">int</span> prime[MAXN];</div><div class="line"><span class="keyword">bool</span> is_prime[MAXN];</div><div class="line"><span class="keyword">int</span> h[MAXN], f[MAXN], q[MAXN], g[MAXN], ans, miu[MAXN];</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">get_prime</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    miu[<span class="number">1</span>] = <span class="number">1</span>;</div><div class="line">    FOR(i, <span class="number">2</span>, a * b) &#123;</div><div class="line">        <span class="keyword">if</span> (!is_prime[i]) &#123;</div><div class="line">            prime[++prime[<span class="number">0</span>]] = i;</div><div class="line">            miu[i] = <span class="number">-1</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; prime[j] * i &lt;= i_END_; j++) &#123;</div><div class="line">            is_prime[prime[j] * i] = <span class="literal">true</span>;</div><div class="line">            <span class="keyword">if</span> (i % prime[j] == <span class="number">0</span>) &#123;</div><div class="line">                miu[prime[j] * i] = <span class="number">0</span>;</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            &#125;</div><div class="line">            miu[prime[j] * i] = -miu[i];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    in(a); in(b); in(c); get_prime();</div><div class="line">    FOR(i, <span class="number">1</span>, c) <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= c; j += i) h[i] = (h[i] + c / j) % MOD;</div><div class="line">    FOR(i, <span class="number">1</span>, a) FOR(j, <span class="number">1</span>, b) f[i * j]++;</div><div class="line">    FOR(i, <span class="number">1</span>, a * b) <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= i_END_; j += i)</div><div class="line">        q[i] = (q[i] + f[j]) % MOD;</div><div class="line">    FOR(i, <span class="number">1</span>, a * b) <span class="keyword">for</span> (<span class="keyword">int</span> j = i; j &lt;= i_END_; j += i)</div><div class="line">        g[j] = (g[j] + <span class="number">1l</span>l * miu[i] * h[i] % MOD) % MOD;</div><div class="line">    FOR(i, <span class="number">1</span>, a * b) g[i] = <span class="number">1l</span>l * g[i] * q[i] % MOD;</div><div class="line">    FOR(i, <span class="number">1</span>, a * b) ans = (ans + g[i]) % MOD;</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;题意&quot;&gt;题意&lt;/h2&gt;
&lt;hr /&gt;
&lt;p&gt;求&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math display&quot;&gt;\[\sum_{i=1}^a\sum_{j=1}^b\sum_{k=1}^cd(ijk)\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;其中，&lt;span class=&quot;math inline&quot;&gt;\(d(i)\)&lt;/span&gt; 表示 &lt;span class=&quot;math inline&quot;&gt;\(i\)&lt;/span&gt; 的约数个数。&lt;/p&gt;
&lt;p&gt;&lt;span class=&quot;math inline&quot;&gt;\(a, b, c\leq 2000\)&lt;/span&gt;&lt;/p&gt;
&lt;hr /&gt;
    
    </summary>
    
      <category term="莫比乌斯反演" scheme="http://yoursite.com/categories/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
    
    
      <category term="莫比乌斯反演" scheme="http://yoursite.com/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
    
  </entry>
  
  <entry>
    <title>test20170325总结</title>
    <link href="http://yoursite.com/2017/03/25/test20170325%E6%80%BB%E7%BB%93/"/>
    <id>http://yoursite.com/2017/03/25/test20170325总结/</id>
    <published>2017-03-25T06:14:03.000Z</published>
    <updated>2017-03-25T07:41:50.144Z</updated>
    
    <content type="html"><![CDATA[<h2 id="test20170325总结">test20170325总结</h2>
<p>做题顺序：T1-&gt;T2-&gt;T3</p>
<a id="more"></a>
<hr>
<h4 id="t1">T1</h4>
<p>这个题目很简单，第一眼看过去就知道可以用很多方法做出来。</p>
<p>我选择了最稳的线段树套pbds，一会儿就写完了，过了对拍。</p>
<p>期望得分：100分。</p>
<p>实际得分：100分。</p>
<hr>
<h4 id="t2">T2</h4>
<p>做了很久都没有做出来，考虑各种方法都失败了。</p>
<p>最后打了一个贪心，想骗一骗分。</p>
<p>期望得分：0+</p>
<p>实际得分：10分。</p>
<p>upd: 现在还只会做第一问，把元素大小减去下标再求LIS就行了！</p>
<hr>
<h4 id="t3">T3</h4>
<p>这个题目也不会做。</p>
<p>本来想打一个spfa骗一骗分，后来发现好像可以分块。</p>
<p>可是分块打得少，直接挂掉了。</p>
<p>期望得分：0+</p>
<p>实际得分：0分。</p>
<p>upd: 正解竟然就是spfa！！！ 打一个spfa就可以水过去！！！</p>
<hr>
<h3 id="总结">总结</h3>
<p>还是思路不够灵活，学过的知识点不能熟练运用。</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;test20170325总结&quot;&gt;test20170325总结&lt;/h2&gt;
&lt;p&gt;做题顺序：T1-&amp;gt;T2-&amp;gt;T3&lt;/p&gt;
    
    </summary>
    
      <category term="TEST" scheme="http://yoursite.com/categories/TEST/"/>
    
    
      <category term="TEST" scheme="http://yoursite.com/tags/TEST/"/>
    
  </entry>
  
  <entry>
    <title>ZJOI考试总结</title>
    <link href="http://yoursite.com/2017/03/24/ZJOI%E6%B8%B8%E8%AE%B0/"/>
    <id>http://yoursite.com/2017/03/24/ZJOI游记/</id>
    <published>2017-03-24T04:28:24.000Z</published>
    <updated>2017-03-30T05:27:08.963Z</updated>
    
    <content type="html"><![CDATA[<h2 id="zjoi考试总结">ZJOI考试总结</h2>
<p>浏览了一边题目，发现ZJOI的题目果然都是变态题。 觉得都只会做暴力，第一题的暴力好像有30分，第三题10~30分，第二题？？ 于是做题顺序为T1-&gt;T3-&gt;T2。</p>
<a id="more"></a>
<hr>
<h4 id="t1">T1</h4>
<p>只会做暴力和链的情况。</p>
<ol style="list-style-type: decimal">
<li>链的情况就是一个简单的DP就好了。</li>
</ol>
<p><blockquote><p>答案不就是 $2^{n-2}$ 吗？</p>
<footer><strong>Xie Chaocai</strong><cite>一个神犇</cite></footer></blockquote></p>
<p>感觉很有道理～</p>
<ol start="2" style="list-style-type: decimal">
<li>暴力的话考虑一下DFS的性质，如果一个点 <span class="math inline">\(u\)</span> 出去的返祖边到了 <span class="math inline">\(v\)</span>，那么 <span class="math inline">\(u - v\)</span> 之间是不能有其他的返祖边的起点或终点的。 标记一下就好了 。</li>
</ol>
<p>期望得分：30分。</p>
<table style="width:14%;">
<colgroup>
<col width="13%">
</colgroup>
<tbody>
<tr class="odd">
<td align="left">#### T3 这个题我没有发现题解中的那个最基本的性质…… 于是直接暴力快速幂+FFT，发现竟然连30分都拿不到！会被卡常！！ 于是只有10分走人……</td>
</tr>
<tr class="even">
<td align="left">期望得分：10分。</td>
</tr>
</tbody>
</table>
<h4 id="t2">T2</h4>
<p>这个题真是太变态了。 前面的随机出来的结果，竟然与后面随机出来的结果，一起对之后的询问有着影响。 于是只能搜索了，将所有随机结果的情况全部搜出来，然后暴力更新解就行了。</p>
<p>虚的不行，不知道有没有10分。</p>
<p>期望得分：10分。</p>
<table style="width:14%;">
<colgroup>
<col width="13%">
</colgroup>
<tbody>
<tr class="odd">
<td align="left">### 总结 还是姿势水平不够，对于性质题没有一点办法…… 计数题和概率题还是做少了题目，一碰到难题就挂掉……</td>
</tr>
</tbody>
</table>
<h4 id="某匿名神犇你zjoi崩了.">某匿名神犇：你ZJOI崩了.</h4>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;zjoi考试总结&quot;&gt;ZJOI考试总结&lt;/h2&gt;
&lt;p&gt;浏览了一边题目，发现ZJOI的题目果然都是变态题。 觉得都只会做暴力，第一题的暴力好像有30分，第三题10~30分，第二题？？ 于是做题顺序为T1-&amp;gt;T3-&amp;gt;T2。&lt;/p&gt;
    
    </summary>
    
      <category term="TEST" scheme="http://yoursite.com/categories/TEST/"/>
    
    
      <category term="TEST" scheme="http://yoursite.com/tags/TEST/"/>
    
  </entry>
  
  <entry>
    <title>Hello world</title>
    <link href="http://yoursite.com/2017/03/23/Hello-world/"/>
    <id>http://yoursite.com/2017/03/23/Hello-world/</id>
    <published>2017-03-23T15:11:03.000Z</published>
    <updated>2017-03-24T04:45:37.969Z</updated>
    
    <content type="html"><![CDATA[<p>这是第一篇博客，测试一下一些功能？</p>
<a id="more"></a>
<h1 id="title-标题">Title 标题</h1>
<h2 id="sub-title-子标题">Sub title 子标题</h2>
<h3 id="sub-sub-title-子子标题">Sub sub title 子子标题</h3>
<p><span class="math display">\[f(x)=f(x_0)+\frac{f&#39;(x_0)(x-x_0)}{1!}+\frac{f&#39;&#39;(x_0)(x-x_0)^2}{2!}+ \cdots +\frac{f^{(n-1)}(x_0)(x-x_0)^{n-1}}{(n-1)!}+\frac{f^{(n)}(\xi)(x-x_0)^n}{n!},x\in[a,b]\]</span></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> FOR(i, a, b) for (int i = (a), i##_END_ = (b); i &lt;= i##_END_; i++)</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> DNF(i, a, b) for (int i = (a), i##_END_ = (b); i &gt;= i##_END_; i--)</span></div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function"><span class="keyword">void</span> <span class="title">in</span><span class="params">(Tp &amp;x)</span> </span>&#123;</div><div class="line">    <span class="keyword">char</span> ch = getchar(), f = <span class="number">1</span>; x = <span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span> (ch != <span class="string">'-'</span> &amp;&amp; (ch &lt; <span class="string">'0'</span> || ch &gt; <span class="string">'9'</span>)) ch = getchar();</div><div class="line">    <span class="keyword">if</span> (ch == <span class="string">'-'</span>) f = <span class="number">-1</span>, ch = getchar();</div><div class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">'0'</span> &amp;&amp; ch &lt;= <span class="string">'9'</span>) x = x * <span class="number">10</span> + ch - <span class="string">'0'</span>, ch = getchar();</div><div class="line">    x *= f;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmax</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">chkmin</span><span class="params">(Tp &amp;x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : x=y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Max</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &gt; y ? x : y;&#125;</div><div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> Tp&gt; <span class="function">Tp <span class="title">Min</span><span class="params">(Tp x, Tp y)</span> </span>&#123;<span class="keyword">return</span> x &lt; y ? x : y;&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;这是第一篇博客，测试一下一些功能？&lt;/p&gt;
    
    </summary>
    
      <category term="Hello world" scheme="http://yoursite.com/categories/Hello-world/"/>
    
    
      <category term="Hello world" scheme="http://yoursite.com/tags/Hello-world/"/>
    
  </entry>
  
</feed>
